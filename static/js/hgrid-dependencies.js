function hGridDropInit(hGrid){var Dropzone=window.Dropzone;Dropzone.autoDiscover=!1;var dropDestination,url,bool=!1;"string"==typeof hGrid.options.urlAdd?url=hGrid.options.urlAdd:(url=hGrid.options.url,bool=!0);var myDropzone=new Dropzone(hGrid.options.container,{url:url,previewsContainer:"#drop-preview-panel",addRemoveLinks:!0});myDropzone.on("dragover",function(e){currentDropCell=hGrid.Slick.grid.getCellFromEvent(e),null===currentDropCell?(dropHighlight=null,dropDestination=null):(currentDropCell.insertBefore=currentDropCell.row,dropDestination=hGrid.data[currentDropCell.row-1]&&"folder"==hGrid.data[currentDropCell.row-1].type?hGrid.data[currentDropCell.row-1].uid:hGrid.data[currentDropCell.row].parent_uid,dropHighlight=null,hGrid.data[currentDropCell.row-1]&&(dropHighlight=hGrid.data[currentDropCell.row-1])),bool&&(console.log(dropDestination),myDropzone.options.url=hGrid.options.urlAdd[dropDestination]),hGrid.draggerGuide(dropHighlight)}),myDropzone.on("dragleave",function(){hGrid.removeDraggerGuide()}),myDropzone.on("sending",function(file,xhr,formData){formData.append("destination",dropDestination)}),myDropzone.on("success",function(file){if(console.log(file),hGrid.removeDraggerGuide(),"Repeat"==file.xhr.response)console.log("The File already exists!");else{var newSlickInfo=JSON.parse(file.xhr.response);hGrid.uploadItem(newSlickInfo[0])}})}if(function(){function require(path,parent,orig){var resolved=require.resolve(path);if(null==resolved){orig=orig||path,parent=parent||"root";var err=new Error('Failed to require "'+orig+'" from "'+parent+'"');throw err.path=orig,err.parent=parent,err.require=!0,err}var module=require.modules[resolved];return module.exports||(module.exports={},module.client=module.component=!0,module.call(this,module.exports,require.relative(resolved),module)),module.exports}require.modules={},require.aliases={},require.resolve=function(path){"/"===path.charAt(0)&&(path=path.slice(1));for(var paths=[path,path+".js",path+".json",path+"/index.js",path+"/index.json"],i=0;i<paths.length;i++){var path=paths[i];if(require.modules.hasOwnProperty(path))return path;if(require.aliases.hasOwnProperty(path))return require.aliases[path]}},require.normalize=function(curr,path){var segs=[];if("."!=path.charAt(0))return path;curr=curr.split("/"),path=path.split("/");for(var i=0;i<path.length;++i)".."==path[i]?curr.pop():"."!=path[i]&&""!=path[i]&&segs.push(path[i]);return curr.concat(segs).join("/")},require.register=function(path,definition){require.modules[path]=definition},require.alias=function(from,to){if(!require.modules.hasOwnProperty(from))throw new Error('Failed to alias "'+from+'", it does not exist');require.aliases[to]=from},require.relative=function(parent){function lastIndexOf(arr,obj){for(var i=arr.length;i--;)if(arr[i]===obj)return i;return-1}function localRequire(path){var resolved=localRequire.resolve(path);return require(resolved,parent,path)}var p=require.normalize(parent,"..");return localRequire.resolve=function(path){var c=path.charAt(0);if("/"==c)return path.slice(1);if("."==c)return require.normalize(p,path);var segs=parent.split("/"),i=lastIndexOf(segs,"deps")+1;return i||(i=0),path=segs.slice(0,i+1).join("/")+"/deps/"+path},localRequire.exists=function(path){return require.modules.hasOwnProperty(localRequire.resolve(path))},localRequire},require.register("component-emitter/index.js",function(exports,require,module){function Emitter(obj){return obj?mixin(obj):void 0}function mixin(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}module.exports=Emitter,Emitter.prototype.on=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks[event]=this._callbacks[event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){self.off(event,on),fn.apply(this,arguments)}var self=this;return this._callbacks=this._callbacks||{},fn._off=on,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=function(event,fn){this._callbacks=this._callbacks||{};var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks[event],this;var i=callbacks.indexOf(fn._off||fn);return~i&&callbacks.splice(i,1),this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;len>i;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks[event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}}),require.register("dropzone/index.js",function(exports,require,module){module.exports=require("./lib/dropzone.js")}),require.register("dropzone/lib/dropzone.js",function(exports,require,module){!function(){var Dropzone,Em,camelize,contentLoaded,noop,without,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice;Em="undefined"!=typeof Emitter&&null!==Emitter?Emitter:require("emitter"),noop=function(){},Dropzone=function(_super){function Dropzone(element,options){var elementOptions,fallback,_ref;if(this.element=element,this.version=Dropzone.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("Dropzone already attached.");if(Dropzone.instances.push(this),element.dropzone=this,elementOptions=null!=(_ref=Dropzone.optionsForElement(this.element))?_ref:{},this.options=extend({},this.defaultOptions,elementOptions,null!=options?options:{}),null==this.options.url&&(this.options.url=this.element.action),!this.options.url)throw new Error("No URL provided.");if(this.options.acceptParameter&&this.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptParameter' and 'acceptedMimeTypes'. 'acceptParameter' is deprecated.");return this.options.method=this.options.method.toUpperCase(),this.options.forceFallback||!Dropzone.isBrowserSupported()?this.options.fallback.call(this):((fallback=this.getExistingFallback())&&fallback.parentNode&&fallback.parentNode.removeChild(fallback),this.previewsContainer=this.options.previewsContainer?Dropzone.getElement(this.options.previewsContainer,"previewsContainer"):this.element,this.options.clickable&&(this.clickableElements=this.options.clickable===!0?[this.element]:Dropzone.getElements(this.options.clickable,"clickable")),this.init(),void 0)}var extend;return __extends(Dropzone,_super),Dropzone.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","selectedfiles","addedfile","removedfile","thumbnail","error","processingfile","uploadprogress","totaluploadprogress","sending","success","complete","reset"],Dropzone.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:100,thumbnailHeight:100,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedMimeTypes:null,acceptParameter:null,enqueueForUpload:!0,addRemoveLinks:!1,previewsContainer:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MB). Max filesize: {{maxFilesize}}MB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",accept:function(file,done){return done()},init:function(){return noop},forceFallback:!1,fallback:function(){var child,messageElement,span,_i,_len,_ref;for(this.element.className=""+this.element.className+" dz-browser-not-supported",_ref=this.element.getElementsByTagName("div"),_i=0,_len=_ref.length;_len>_i;_i++)child=_ref[_i],/(^| )dz-message($| )/.test(child.className)&&(messageElement=child,child.className="dz-message");return messageElement||(messageElement=Dropzone.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(messageElement)),span=messageElement.getElementsByTagName("span")[0],span&&(span.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(file){var info,srcRatio,trgRatio;return info={srcX:0,srcY:0,srcWidth:file.width,srcHeight:file.height},srcRatio=file.width/file.height,trgRatio=this.options.thumbnailWidth/this.options.thumbnailHeight,file.height<this.options.thumbnailHeight||file.width<this.options.thumbnailWidth?(info.trgHeight=info.srcHeight,info.trgWidth=info.srcWidth):srcRatio>trgRatio?(info.srcHeight=file.height,info.srcWidth=info.srcHeight*trgRatio):(info.srcWidth=file.width,info.srcHeight=info.srcWidth/trgRatio),info.srcX=(file.width-info.srcWidth)/2,info.srcY=(file.height-info.srcHeight)/2,info},drop:function(){return this.element.classList.remove("dz-drag-hover")},dragstart:noop,dragend:function(){return this.element.classList.remove("dz-drag-hover")},dragenter:function(){return this.element.classList.add("dz-drag-hover")},dragover:function(){return this.element.classList.add("dz-drag-hover")},dragleave:function(){return this.element.classList.remove("dz-drag-hover")},selectedfiles:function(){return this.element===this.previewsContainer?this.element.classList.add("dz-started"):void 0},reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(file){var _this=this;return file.previewElement=Dropzone.createElement(this.options.previewTemplate),file.previewTemplate=file.previewElement,this.previewsContainer.appendChild(file.previewElement),file.previewElement.querySelector("[data-dz-name]").textContent=file.name,file.previewElement.querySelector("[data-dz-size]").innerHTML=this.filesize(file.size),this.options.addRemoveLinks?(file._removeLink=Dropzone.createElement('<a class="dz-remove" href="javascript:undefined;">'+this.options.dictRemoveFile+"</a>"),file._removeLink.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),file.status!==Dropzone.UPLOADING?_this.removeFile(file):window.confirm(_this.options.dictCancelUploadConfirmation)?_this.removeFile(file):void 0}),file.previewElement.appendChild(file._removeLink)):void 0},removedfile:function(file){var _ref;return null!=(_ref=file.previewElement)?_ref.parentNode.removeChild(file.previewElement):void 0},thumbnail:function(file,dataUrl){var thumbnailElement;return file.previewElement.classList.remove("dz-file-preview"),file.previewElement.classList.add("dz-image-preview"),thumbnailElement=file.previewElement.querySelector("[data-dz-thumbnail]"),thumbnailElement.alt=file.name,thumbnailElement.src=dataUrl},error:function(file,message){return file.previewElement.classList.add("dz-error"),file.previewElement.querySelector("[data-dz-errormessage]").textContent=message},processingfile:function(file){return file.previewElement.classList.add("dz-processing"),file._removeLink?file._removeLink.textContent=this.options.dictCancelUpload:void 0},uploadprogress:function(file,progress){return file.previewElement.querySelector("[data-dz-uploadprogress]").style.width=""+progress+"%"},totaluploadprogress:noop,sending:noop,success:function(file){return file.previewElement.classList.add("dz-success")},complete:function(file){return file._removeLink?file._removeLink.textContent=this.options.dictRemoveFile:void 0},previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-details">\n    <div class="dz-filename"><span data-dz-name></span></div>\n    <div class="dz-size" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-success-mark"><span>✔</span></div>\n  <div class="dz-error-mark"><span>✘</span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n</div>'},extend=function(){var key,object,objects,target,val,_i,_len;for(target=arguments[0],objects=2<=arguments.length?__slice.call(arguments,1):[],_i=0,_len=objects.length;_len>_i;_i++){object=objects[_i];for(key in object)val=object[key],target[key]=val}return target},Dropzone.prototype.getAcceptedFiles=function(){var file,_i,_len,_ref,_results;for(_ref=this.files,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)file=_ref[_i],file.accepted&&_results.push(file);return _results},Dropzone.prototype.getRejectedFiles=function(){var file,_i,_len,_ref,_results;if(!file.accepted){for(_ref=this.files,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)file=_ref[_i],_results.push(file);return _results}},Dropzone.prototype.getQueuedFiles=function(){var file,_i,_len,_ref,_results;for(_ref=this.files,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)file=_ref[_i],file.status===Dropzone.QUEUED&&_results.push(file);return _results},Dropzone.prototype.getUploadingFiles=function(){var file,_i,_len,_ref,_results;for(_ref=this.files,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)file=_ref[_i],file.status===Dropzone.UPLOADING&&_results.push(file);return _results},Dropzone.prototype.enqueueFile=function(file){if(file.status===Dropzone.ACCEPTED)return file.status=Dropzone.QUEUED,this.processQueue();throw new Error("This file can't be queued because it has already been processed or was rejected.")},Dropzone.prototype.init=function(){var eventName,noPropagation,setupHiddenFileInput,_i,_len,_ref,_ref1,_this=this;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(Dropzone.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(setupHiddenFileInput=function(){return _this.hiddenFileInput&&document.body.removeChild(_this.hiddenFileInput),_this.hiddenFileInput=document.createElement("input"),_this.hiddenFileInput.setAttribute("type","file"),_this.hiddenFileInput.setAttribute("multiple","multiple"),null!=_this.options.acceptedMimeTypes&&_this.hiddenFileInput.setAttribute("accept",_this.options.acceptedMimeTypes),null!=_this.options.acceptParameter&&_this.hiddenFileInput.setAttribute("accept",_this.options.acceptParameter),_this.hiddenFileInput.style.visibility="hidden",_this.hiddenFileInput.style.position="absolute",_this.hiddenFileInput.style.top="0",_this.hiddenFileInput.style.left="0",_this.hiddenFileInput.style.height="0",_this.hiddenFileInput.style.width="0",document.body.appendChild(_this.hiddenFileInput),_this.hiddenFileInput.addEventListener("change",function(){var files;return files=_this.hiddenFileInput.files,files.length&&(_this.emit("selectedfiles",files),_this.handleFiles(files)),setupHiddenFileInput()})},setupHiddenFileInput()),this.URL=null!=(_ref=window.URL)?_ref:window.webkitURL,_ref1=this.events,_i=0,_len=_ref1.length;_len>_i;_i++)eventName=_ref1[_i],this.on(eventName,this.options[eventName]);return this.on("uploadprogress",function(){return _this.updateTotalUploadProgress()}),this.on("removedfile",function(){return _this.updateTotalUploadProgress()}),noPropagation=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return _this.emit("dragstart",e)},dragenter:function(e){return noPropagation(e),_this.emit("dragenter",e)},dragover:function(e){return noPropagation(e),_this.emit("dragover",e)},dragleave:function(e){return _this.emit("dragleave",e)},drop:function(e){return noPropagation(e),_this.drop(e),_this.emit("drop",e)},dragend:function(e){return _this.emit("dragend",e)}}}],this.clickableElements.forEach(function(clickableElement){return _this.listeners.push({element:clickableElement,events:{click:function(evt){return clickableElement!==_this.element||evt.target===_this.element||Dropzone.elementInside(evt.target,_this.element.querySelector(".dz-message"))?_this.hiddenFileInput.click():void 0}}})}),this.enable(),this.options.init.call(this)},Dropzone.prototype.destroy=function(){var _ref;return this.disable(),this.removeAllFiles(!0),(null!=(_ref=this.hiddenFileInput)?_ref.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone},Dropzone.prototype.updateTotalUploadProgress=function(){var acceptedFiles,file,totalBytes,totalBytesSent,totalUploadProgress,_i,_len,_ref;if(totalBytesSent=0,totalBytes=0,acceptedFiles=this.getAcceptedFiles(),acceptedFiles.length){for(_ref=this.getAcceptedFiles(),_i=0,_len=_ref.length;_len>_i;_i++)file=_ref[_i],totalBytesSent+=file.upload.bytesSent,totalBytes+=file.upload.total;totalUploadProgress=100*totalBytesSent/totalBytes}else totalUploadProgress=100;return this.emit("totaluploadprogress",totalUploadProgress,totalBytes,totalBytesSent)},Dropzone.prototype.getFallbackForm=function(){var existingFallback,fields,fieldsString,form;return(existingFallback=this.getExistingFallback())?existingFallback:(fieldsString='<div class="dz-fallback">',this.options.dictFallbackText&&(fieldsString+="<p>"+this.options.dictFallbackText+"</p>"),fieldsString+='<input type="file" name="'+this.options.paramName+'[]" multiple="multiple" /><button type="submit">Upload!</button></div>',fields=Dropzone.createElement(fieldsString),"FORM"!==this.element.tagName?(form=Dropzone.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),form.appendChild(fields)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=form?form:fields)},Dropzone.prototype.getExistingFallback=function(){var fallback,getFallback,tagName,_i,_len,_ref;for(getFallback=function(elements){var el,_i,_len;for(_i=0,_len=elements.length;_len>_i;_i++)if(el=elements[_i],/(^| )fallback($| )/.test(el.className))return el},_ref=["div","form"],_i=0,_len=_ref.length;_len>_i;_i++)if(tagName=_ref[_i],fallback=getFallback(this.element.getElementsByTagName(tagName)))return fallback},Dropzone.prototype.setupEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;for(_ref=this.listeners,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)elementListeners=_ref[_i],_results.push(function(){var _ref1,_results1;_ref1=elementListeners.events,_results1=[];for(event in _ref1)listener=_ref1[event],_results1.push(elementListeners.element.addEventListener(event,listener,!1));return _results1}());return _results},Dropzone.prototype.removeEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;for(_ref=this.listeners,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)elementListeners=_ref[_i],_results.push(function(){var _ref1,_results1;_ref1=elementListeners.events,_results1=[];for(event in _ref1)listener=_ref1[event],_results1.push(elementListeners.element.removeEventListener(event,listener,!1));return _results1}());return _results},Dropzone.prototype.disable=function(){var file,_i,_len,_ref,_results;for(this.clickableElements.forEach(function(element){return element.classList.remove("dz-clickable")}),this.removeEventListeners(),_ref=this.files,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)file=_ref[_i],_results.push(this.cancelUpload(file));return _results},Dropzone.prototype.enable=function(){return this.clickableElements.forEach(function(element){return element.classList.add("dz-clickable")}),this.setupEventListeners()},Dropzone.prototype.filesize=function(size){var string;return size>=1e11?(size/=1e11,string="TB"):size>=1e8?(size/=1e8,string="GB"):size>=1e5?(size/=1e5,string="MB"):size>=100?(size/=100,string="KB"):(size=10*size,string="b"),"<strong>"+Math.round(size)/10+"</strong> "+string},Dropzone.prototype.drop=function(e){var files,items;e.dataTransfer&&(files=e.dataTransfer.files,this.emit("selectedfiles",files),files.length&&(items=e.dataTransfer.items,items&&items.length&&(null!=items[0].webkitGetAsEntry||null!=items[0].getAsEntry)?this.handleItems(items):this.handleFiles(files)))},Dropzone.prototype.handleFiles=function(files){var file,_i,_len,_results;for(_results=[],_i=0,_len=files.length;_len>_i;_i++)file=files[_i],_results.push(this.addFile(file));return _results},Dropzone.prototype.handleItems=function(items){var entry,item,_i,_len;for(_i=0,_len=items.length;_len>_i;_i++)item=items[_i],null!=item.webkitGetAsEntry?(entry=item.webkitGetAsEntry(),entry.isFile?this.addFile(item.getAsFile()):entry.isDirectory&&this.addDirectory(entry,entry.name)):this.addFile(item.getAsFile())},Dropzone.prototype.accept=function(file,done){return file.size>1024*1024*this.options.maxFilesize?done(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(file.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):Dropzone.isValidMimeType(file.type,this.options.acceptedMimeTypes)?this.options.accept.call(this,file,done):done(this.options.dictInvalidFileType)},Dropzone.prototype.addFile=function(file){var _this=this;return file.upload={progress:0,total:file.size,bytesSent:0},this.files.push(file),file.status=Dropzone.ADDED,this.emit("addedfile",file),this.options.createImageThumbnails&&file.type.match(/image.*/)&&file.size<=1024*1024*this.options.maxThumbnailFilesize&&this.createThumbnail(file),this.accept(file,function(error){return error?(file.accepted=!1,_this.errorProcessing(file,error)):(file.status=Dropzone.ACCEPTED,file.accepted=!0,_this.options.enqueueForUpload?(file.status=Dropzone.QUEUED,_this.processQueue()):void 0)})},Dropzone.prototype.addDirectory=function(entry,path){var dirReader,entriesReader,_this=this;return dirReader=entry.createReader(),entriesReader=function(entries){var _i,_len;for(_i=0,_len=entries.length;_len>_i;_i++)entry=entries[_i],entry.isFile?entry.file(function(file){return _this.options.ignoreHiddenFiles&&"."===file.name.substring(0,1)?void 0:(file.fullPath=""+path+"/"+file.name,_this.addFile(file))}):entry.isDirectory&&_this.addDirectory(entry,""+path+"/"+entry.name)},dirReader.readEntries(entriesReader,function(error){return"undefined"!=typeof console&&null!==console?"function"==typeof console.log?console.log(error):void 0:void 0})},Dropzone.prototype.removeFile=function(file){return file.status===Dropzone.UPLOADING&&this.cancelUpload(file),this.files=without(this.files,file),this.emit("removedfile",file),0===this.files.length?this.emit("reset"):void 0},Dropzone.prototype.removeAllFiles=function(cancelIfNecessary){var file,_i,_len,_ref;for(null==cancelIfNecessary&&(cancelIfNecessary=!1),_ref=this.files.slice(),_i=0,_len=_ref.length;_len>_i;_i++)file=_ref[_i],(file.status!==Dropzone.UPLOADING||cancelIfNecessary)&&this.removeFile(file);return null},Dropzone.prototype.createThumbnail=function(file){var fileReader,_this=this;return fileReader=new FileReader,fileReader.onload=function(){var img;return img=new Image,img.onload=function(){var canvas,ctx,resizeInfo,thumbnail,_ref,_ref1,_ref2,_ref3;return file.width=img.width,file.height=img.height,resizeInfo=_this.options.resize.call(_this,file),null==resizeInfo.trgWidth&&(resizeInfo.trgWidth=_this.options.thumbnailWidth),null==resizeInfo.trgHeight&&(resizeInfo.trgHeight=_this.options.thumbnailHeight),canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),canvas.width=resizeInfo.trgWidth,canvas.height=resizeInfo.trgHeight,ctx.drawImage(img,null!=(_ref=resizeInfo.srcX)?_ref:0,null!=(_ref1=resizeInfo.srcY)?_ref1:0,resizeInfo.srcWidth,resizeInfo.srcHeight,null!=(_ref2=resizeInfo.trgX)?_ref2:0,null!=(_ref3=resizeInfo.trgY)?_ref3:0,resizeInfo.trgWidth,resizeInfo.trgHeight),thumbnail=canvas.toDataURL("image/png"),_this.emit("thumbnail",file,thumbnail)},img.src=fileReader.result},fileReader.readAsDataURL(file)},Dropzone.prototype.processQueue=function(){var i,parallelUploads,processingLength,queuedFiles;for(parallelUploads=this.options.parallelUploads,processingLength=this.getUploadingFiles().length,i=processingLength,queuedFiles=this.getQueuedFiles();parallelUploads>i;){if(!queuedFiles.length)return;this.processFile(queuedFiles.shift()),i++}},Dropzone.prototype.processFile=function(file){return file.processing=!0,file.status=Dropzone.UPLOADING,this.emit("processingfile",file),this.uploadFile(file)},Dropzone.prototype.cancelUpload=function(file){var _ref;return file.status===Dropzone.UPLOADING?(file.status=Dropzone.CANCELED,file.xhr.abort()):((_ref=file.status)===Dropzone.ADDED||_ref===Dropzone.ACCEPTED||_ref===Dropzone.QUEUED)&&(file.status=Dropzone.CANCELED),this.emit("complete",file),this.processQueue()},Dropzone.prototype.uploadFile=function(file){var formData,handleError,header,headers,input,inputName,inputType,key,name,progressObj,response,updateProgress,value,xhr,_i,_len,_ref,_ref1,_ref2,_this=this;xhr=new XMLHttpRequest,file.xhr=xhr,xhr.open(this.options.method,this.options.url,!0),xhr.withCredentials=!!this.options.withCredentials,response=null,handleError=function(){return _this.errorProcessing(file,response||_this.options.dictResponseError.replace("{{statusCode}}",xhr.status),xhr)},updateProgress=function(e){var progress;if(null!=e)progress=100*e.loaded/e.total,file.upload={progress:progress,total:e.total,bytesSent:e.loaded};else{if(100===file.upload.progress&&file.upload.bytesSent===file.upload.total)return;progress=100,file.upload.progress=progress,file.upload.bytesSent=file.upload.total}return _this.emit("uploadprogress",file,progress,file.upload.bytesSent)},xhr.onload=function(e){var _ref;if(file.status!==Dropzone.CANCELED&&4===xhr.readyState){if(response=xhr.responseText,xhr.getResponseHeader("content-type")&&~xhr.getResponseHeader("content-type").indexOf("application/json"))try{response=JSON.parse(response)}catch(_error){e=_error,response="Invalid JSON response from server."}return updateProgress(),200<=(_ref=xhr.status)&&300>_ref?_this.finished(file,response,e):handleError()}},xhr.onerror=function(){return file.status!==Dropzone.CANCELED?handleError():void 0},progressObj=null!=(_ref=xhr.upload)?_ref:xhr,progressObj.onprogress=updateProgress,headers={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest","X-File-Name":encodeURIComponent(file.name)},this.options.headers&&extend(headers,this.options.headers);for(header in headers)name=headers[header],xhr.setRequestHeader(header,name);if(formData=new FormData,this.options.params){_ref1=this.options.params;for(key in _ref1)value=_ref1[key],formData.append(key,value)}if("FORM"===this.element.tagName)for(_ref2=this.element.querySelectorAll("input, textarea, select, button"),_i=0,_len=_ref2.length;_len>_i;_i++)input=_ref2[_i],inputName=input.getAttribute("name"),inputType=input.getAttribute("type"),(!inputType||"checkbox"!==inputType.toLowerCase()||input.checked)&&formData.append(inputName,input.value);return this.emit("sending",file,xhr,formData),formData.append(this.options.paramName,file),xhr.send(formData)},Dropzone.prototype.finished=function(file,responseText,e){return file.status=Dropzone.SUCCESS,this.processQueue(),this.emit("success",file,responseText,e),this.emit("finished",file,responseText,e),this.emit("complete",file)},Dropzone.prototype.errorProcessing=function(file,message,xhr){return file.status=Dropzone.ERROR,this.processQueue(),this.emit("error",file,message,xhr),this.emit("complete",file)},Dropzone}(Em),Dropzone.version="3.5.3",Dropzone.options={},Dropzone.optionsForElement=function(element){return element.id?Dropzone.options[camelize(element.id)]:void 0},Dropzone.instances=[],Dropzone.forElement=function(element){if("string"==typeof element&&(element=document.querySelector(element)),null==(null!=element?element.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return element.dropzone},Dropzone.autoDiscover=!0,Dropzone.discover=function(){var checkElements,dropzone,dropzones,_i,_len,_results;if(Dropzone.autoDiscover){for(document.querySelectorAll?dropzones=document.querySelectorAll(".dropzone"):(dropzones=[],checkElements=function(elements){var el,_i,_len,_results;for(_results=[],_i=0,_len=elements.length;_len>_i;_i++)el=elements[_i],/(^| )dropzone($| )/.test(el.className)?_results.push(dropzones.push(el)):_results.push(void 0);return _results},checkElements(document.getElementsByTagName("div")),checkElements(document.getElementsByTagName("form"))),_results=[],_i=0,_len=dropzones.length;_len>_i;_i++)dropzone=dropzones[_i],Dropzone.optionsForElement(dropzone)!==!1?_results.push(new Dropzone(dropzone)):_results.push(void 0);return _results}},Dropzone.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],Dropzone.isBrowserSupported=function(){var capableBrowser,regex,_i,_len,_ref;if(capableBrowser=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(_ref=Dropzone.blacklistedBrowsers,_i=0,_len=_ref.length;_len>_i;_i++)regex=_ref[_i],regex.test(navigator.userAgent)&&(capableBrowser=!1);else capableBrowser=!1;else capableBrowser=!1;return capableBrowser},without=function(list,rejectedItem){var item,_i,_len,_results;for(_results=[],_i=0,_len=list.length;_len>_i;_i++)item=list[_i],item!==rejectedItem&&_results.push(item);return _results},camelize=function(str){return str.replace(/[\-_](\w)/g,function(match){return match[1].toUpperCase()})},Dropzone.createElement=function(string){var div;return div=document.createElement("div"),div.innerHTML=string,div.childNodes[0]},Dropzone.elementInside=function(element,container){if(element===container)return!0;for(;element=element.parentNode;)if(element===container)return!0;return!1},Dropzone.getElement=function(el,name){var element;if("string"==typeof el?element=document.querySelector(el):null!=el.nodeType&&(element=el),null==element)throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector or a plain HTML element.");return element},Dropzone.getElements=function(els,name){var e,el,elements,_i,_j,_len,_len1,_ref;if(els instanceof Array){elements=[];try{for(_i=0,_len=els.length;_len>_i;_i++)el=els[_i],elements.push(this.getElement(el,name))}catch(_error){e=_error,elements=null}}else if("string"==typeof els)for(elements=[],_ref=document.querySelectorAll(els),_j=0,_len1=_ref.length;_len1>_j;_j++)el=_ref[_j],elements.push(el);else null!=els.nodeType&&(elements=[els]);if(null==elements||!elements.length)throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return elements},Dropzone.isValidMimeType=function(mimeType,acceptedMimeTypes){var baseMimeType,validMimeType,_i,_len;if(!acceptedMimeTypes)return!0;for(acceptedMimeTypes=acceptedMimeTypes.split(","),baseMimeType=mimeType.replace(/\/.*$/,""),_i=0,_len=acceptedMimeTypes.length;_len>_i;_i++)if(validMimeType=acceptedMimeTypes[_i],validMimeType=validMimeType.trim(),/\/\*$/.test(validMimeType)){if(baseMimeType===validMimeType.replace(/\/.*$/,""))return!0}else if(mimeType===validMimeType)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(options){return this.each(function(){return new Dropzone(this,options)
})}),"undefined"!=typeof module&&null!==module?module.exports=Dropzone:window.Dropzone=Dropzone,Dropzone.ADDED="added",Dropzone.ACCEPTED="accepted",Dropzone.QUEUED="queued",Dropzone.UPLOADING="uploading",Dropzone.PROCESSING=Dropzone.UPLOADING,Dropzone.CANCELED="canceled",Dropzone.ERROR="error",Dropzone.SUCCESS="success",contentLoaded=function(win,fn){var add,doc,done,init,poll,pre,rem,root,top;if(done=!1,top=!0,doc=win.document,root=doc.documentElement,add=doc.addEventListener?"addEventListener":"attachEvent",rem=doc.addEventListener?"removeEventListener":"detachEvent",pre=doc.addEventListener?"":"on",init=function(e){return"readystatechange"!==e.type||"complete"===doc.readyState?(("load"===e.type?win:doc)[rem](pre+e.type,init,!1),!done&&(done=!0)?fn.call(win,e.type||e):void 0):void 0},poll=function(){var e;try{root.doScroll("left")}catch(_error){return e=_error,setTimeout(poll,50),void 0}return init("poll")},"complete"!==doc.readyState){if(doc.createEventObject&&root.doScroll){try{top=!win.frameElement}catch(_error){}top&&poll()}return doc[add](pre+"DOMContentLoaded",init,!1),doc[add](pre+"readystatechange",init,!1),win[add](pre+"load",init,!1)}},contentLoaded(window,Dropzone.discover)}.call(this)}),require.alias("component-emitter/index.js","dropzone/deps/emitter/index.js"),require.alias("component-emitter/index.js","emitter/index.js"),"object"==typeof exports?module.exports=require("dropzone"):"function"==typeof define&&define.amd?define(function(){return require("dropzone")}):this.Dropzone=require("dropzone")}(),function($){function EventData(){var isPropagationStopped=!1,isImmediatePropagationStopped=!1;this.stopPropagation=function(){isPropagationStopped=!0},this.isPropagationStopped=function(){return isPropagationStopped},this.stopImmediatePropagation=function(){isImmediatePropagationStopped=!0},this.isImmediatePropagationStopped=function(){return isImmediatePropagationStopped}}function Event(){var handlers=[];this.subscribe=function(fn){handlers.push(fn)},this.unsubscribe=function(fn){for(var i=handlers.length-1;i>=0;i--)handlers[i]===fn&&handlers.splice(i,1)},this.notify=function(args,e,scope){e=e||new EventData,scope=scope||this;for(var returnValue,i=0;i<handlers.length&&!e.isPropagationStopped()&&!e.isImmediatePropagationStopped();i++)returnValue=handlers[i].call(scope,e,args);return returnValue}}function EventHandler(){var handlers=[];this.subscribe=function(event,handler){return handlers.push({event:event,handler:handler}),event.subscribe(handler),this},this.unsubscribe=function(event,handler){for(var i=handlers.length;i--;)if(handlers[i].event===event&&handlers[i].handler===handler)return handlers.splice(i,1),event.unsubscribe(handler),void 0;return this},this.unsubscribeAll=function(){for(var i=handlers.length;i--;)handlers[i].event.unsubscribe(handlers[i].handler);return handlers=[],this}}function Range(fromRow,fromCell,toRow,toCell){void 0===toRow&&void 0===toCell&&(toRow=fromRow,toCell=fromCell),this.fromRow=Math.min(fromRow,toRow),this.fromCell=Math.min(fromCell,toCell),this.toRow=Math.max(fromRow,toRow),this.toCell=Math.max(fromCell,toCell),this.isSingleRow=function(){return this.fromRow==this.toRow},this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},this.contains=function(row,cell){return row>=this.fromRow&&row<=this.toRow&&cell>=this.fromCell&&cell<=this.toCell},this.toString=function(){return this.isSingleCell()?"("+this.fromRow+":"+this.fromCell+")":"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}}function NonDataItem(){this.__nonDataRow=!0}function Group(){this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=null}function GroupTotals(){this.__groupTotals=!0,this.group=null}function EditorLock(){var activeEditController=null;this.isActive=function(editController){return editController?activeEditController===editController:null!==activeEditController},this.activate=function(editController){if(editController!==activeEditController){if(null!==activeEditController)throw"SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController";if(!editController.commitCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()";if(!editController.cancelCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()";activeEditController=editController}},this.deactivate=function(editController){if(activeEditController!==editController)throw"SlickGrid.EditorLock.deactivate: specified editController is not the currently active one";activeEditController=null},this.commitCurrentEdit=function(){return activeEditController?activeEditController.commitCurrentEdit():!0},this.cancelCurrentEdit=function(){return activeEditController?activeEditController.cancelCurrentEdit():!0}}$.extend(!0,window,{Slick:{Event:Event,EventData:EventData,EventHandler:EventHandler,Range:Range,NonDataRow:NonDataItem,Group:Group,GroupTotals:GroupTotals,EditorLock:EditorLock,GlobalEditorLock:new EditorLock}}),Group.prototype=new NonDataItem,Group.prototype.equals=function(group){return this.value===group.value&&this.count===group.count&&this.collapsed===group.collapsed},GroupTotals.prototype=new NonDataItem}(jQuery),function($){function PercentCompleteFormatter(row,cell,value){return null==value||""===value?"-":50>value?"<span style='color:red;font-weight:bold;'>"+value+"%</span>":"<span style='color:green'>"+value+"%</span>"}function PercentCompleteBarFormatter(row,cell,value){if(null==value||""===value)return"";var color;return color=30>value?"red":70>value?"silver":"green","<span class='percent-complete-bar' style='background:"+color+";width:"+value+"%'></span>"}function YesNoFormatter(row,cell,value){return value?"Yes":"No"}function CheckmarkFormatter(row,cell,value){return value?"<img src='../images/tick.png'>":""}$.extend(!0,window,{Slick:{Formatters:{PercentComplete:PercentCompleteFormatter,PercentCompleteBar:PercentCompleteBarFormatter,YesNo:YesNoFormatter,Checkmark:CheckmarkFormatter}}})}(jQuery),function($){function TextEditor(args){var $input,defaultValue;this.init=function(){$input=$("<INPUT type=text class='editor-text' />").appendTo(args.container).bind("keydown.nav",function(e){(e.keyCode===$.ui.keyCode.LEFT||e.keyCode===$.ui.keyCode.RIGHT)&&e.stopImmediatePropagation()}).focus().select()},this.destroy=function(){$input.remove()},this.focus=function(){$input.focus()},this.getValue=function(){return $input.val()},this.setValue=function(val){$input.val(val)},this.loadValue=function(item){defaultValue=item[args.column.field]||"",$input.val(defaultValue),$input[0].defaultValue=defaultValue,$input.select()},this.serializeValue=function(){return $input.val()},this.applyValue=function(item,state){item[args.column.field]=state},this.isValueChanged=function(){return!(""==$input.val()&&null==defaultValue)&&$input.val()!=defaultValue},this.validate=function(){if(args.column.validator){var validationResults=args.column.validator($input.val());if(!validationResults.valid)return validationResults}return{valid:!0,msg:null}},this.init()}function IntegerEditor(args){var $input,defaultValue;this.init=function(){$input=$("<INPUT type=text class='editor-text' />"),$input.bind("keydown.nav",function(e){(e.keyCode===$.ui.keyCode.LEFT||e.keyCode===$.ui.keyCode.RIGHT)&&e.stopImmediatePropagation()}),$input.appendTo(args.container),$input.focus().select()},this.destroy=function(){$input.remove()},this.focus=function(){$input.focus()},this.loadValue=function(item){defaultValue=item[args.column.field],$input.val(defaultValue),$input[0].defaultValue=defaultValue,$input.select()},this.serializeValue=function(){return parseInt($input.val(),10)||0},this.applyValue=function(item,state){item[args.column.field]=state},this.isValueChanged=function(){return!(""==$input.val()&&null==defaultValue)&&$input.val()!=defaultValue},this.validate=function(){return isNaN($input.val())?{valid:!1,msg:"Please enter a valid integer"}:{valid:!0,msg:null}},this.init()}function DateEditor(args){var $input,defaultValue,calendarOpen=!1;this.init=function(){$input=$("<INPUT type=text class='editor-text' />"),$input.appendTo(args.container),$input.focus().select(),$input.datepicker({showOn:"button",buttonImageOnly:!0,buttonImage:"../images/calendar.gif",beforeShow:function(){calendarOpen=!0},onClose:function(){calendarOpen=!1}}),$input.width($input.width()-18)},this.destroy=function(){$.datepicker.dpDiv.stop(!0,!0),$input.datepicker("hide"),$input.datepicker("destroy"),$input.remove()},this.show=function(){calendarOpen&&$.datepicker.dpDiv.stop(!0,!0).show()},this.hide=function(){calendarOpen&&$.datepicker.dpDiv.stop(!0,!0).hide()},this.position=function(position){calendarOpen&&$.datepicker.dpDiv.css("top",position.top+30).css("left",position.left)},this.focus=function(){$input.focus()},this.loadValue=function(item){defaultValue=item[args.column.field],$input.val(defaultValue),$input[0].defaultValue=defaultValue,$input.select()},this.serializeValue=function(){return $input.val()},this.applyValue=function(item,state){item[args.column.field]=state},this.isValueChanged=function(){return!(""==$input.val()&&null==defaultValue)&&$input.val()!=defaultValue},this.validate=function(){return{valid:!0,msg:null}},this.init()}function YesNoSelectEditor(args){var $select,defaultValue;this.init=function(){$select=$("<SELECT tabIndex='0' class='editor-yesno'><OPTION value='yes'>Yes</OPTION><OPTION value='no'>No</OPTION></SELECT>"),$select.appendTo(args.container),$select.focus()},this.destroy=function(){$select.remove()},this.focus=function(){$select.focus()},this.loadValue=function(item){$select.val((defaultValue=item[args.column.field])?"yes":"no"),$select.select()},this.serializeValue=function(){return"yes"==$select.val()},this.applyValue=function(item,state){item[args.column.field]=state},this.isValueChanged=function(){return $select.val()!=defaultValue},this.validate=function(){return{valid:!0,msg:null}},this.init()}function CheckboxEditor(args){var $select,defaultValue;this.init=function(){$select=$("<INPUT type=checkbox value='true' class='editor-checkbox' hideFocus>"),$select.appendTo(args.container),$select.focus()},this.destroy=function(){$select.remove()},this.focus=function(){$select.focus()},this.loadValue=function(item){defaultValue=!!item[args.column.field],defaultValue?$select.attr("checked","checked"):$select.removeAttr("checked")},this.serializeValue=function(){return!!$select.attr("checked")},this.applyValue=function(item,state){item[args.column.field]=state},this.isValueChanged=function(){return this.serializeValue()!==defaultValue},this.validate=function(){return{valid:!0,msg:null}},this.init()}function PercentCompleteEditor(args){var $input,$picker,defaultValue;this.init=function(){$input=$("<INPUT type=text class='editor-percentcomplete' />"),$input.width($(args.container).innerWidth()-25),$input.appendTo(args.container),$picker=$("<div class='editor-percentcomplete-picker' />").appendTo(args.container),$picker.append("<div class='editor-percentcomplete-helper'><div class='editor-percentcomplete-wrapper'><div class='editor-percentcomplete-slider' /><div class='editor-percentcomplete-buttons' /></div></div>"),$picker.find(".editor-percentcomplete-buttons").append("<button val=0>Not started</button><br/><button val=50>In Progress</button><br/><button val=100>Complete</button>"),$input.focus().select(),$picker.find(".editor-percentcomplete-slider").slider({orientation:"vertical",range:"min",value:defaultValue,slide:function(event,ui){$input.val(ui.value)}}),$picker.find(".editor-percentcomplete-buttons button").bind("click",function(){$input.val($(this).attr("val")),$picker.find(".editor-percentcomplete-slider").slider("value",$(this).attr("val"))})},this.destroy=function(){$input.remove(),$picker.remove()},this.focus=function(){$input.focus()},this.loadValue=function(item){$input.val(defaultValue=item[args.column.field]),$input.select()},this.serializeValue=function(){return parseInt($input.val(),10)||0},this.applyValue=function(item,state){item[args.column.field]=state},this.isValueChanged=function(){return!(""==$input.val()&&null==defaultValue)&&(parseInt($input.val(),10)||0)!=defaultValue},this.validate=function(){return isNaN(parseInt($input.val(),10))?{valid:!1,msg:"Please enter a valid positive number"}:{valid:!0,msg:null}},this.init()}function LongTextEditor(args){var $input,$wrapper,defaultValue,scope=this;this.init=function(){var $container=$("body");$wrapper=$("<DIV style='z-index:10000;position:absolute;background:white;padding:5px;border:3px solid gray; -moz-border-radius:10px; border-radius:10px;'/>").appendTo($container),$input=$("<TEXTAREA hidefocus rows=5 style='backround:white;width:250px;height:80px;border:0;outline:0'>").appendTo($wrapper),$("<DIV style='text-align:right'><BUTTON>Save</BUTTON><BUTTON>Cancel</BUTTON></DIV>").appendTo($wrapper),$wrapper.find("button:first").bind("click",this.save),$wrapper.find("button:last").bind("click",this.cancel),$input.bind("keydown",this.handleKeyDown),scope.position(args.position),$input.focus().select()},this.handleKeyDown=function(e){e.which==$.ui.keyCode.ENTER&&e.ctrlKey?scope.save():e.which==$.ui.keyCode.ESCAPE?(e.preventDefault(),scope.cancel()):e.which==$.ui.keyCode.TAB&&e.shiftKey?(e.preventDefault(),args.grid.navigatePrev()):e.which==$.ui.keyCode.TAB&&(e.preventDefault(),args.grid.navigateNext())},this.save=function(){args.commitChanges()},this.cancel=function(){$input.val(defaultValue),args.cancelChanges()},this.hide=function(){$wrapper.hide()},this.show=function(){$wrapper.show()},this.position=function(position){$wrapper.css("top",position.top-5).css("left",position.left-5)},this.destroy=function(){$wrapper.remove()},this.focus=function(){$input.focus()},this.loadValue=function(item){$input.val(defaultValue=item[args.column.field]),$input.select()},this.serializeValue=function(){return $input.val()},this.applyValue=function(item,state){item[args.column.field]=state},this.isValueChanged=function(){return!(""==$input.val()&&null==defaultValue)&&$input.val()!=defaultValue},this.validate=function(){return{valid:!0,msg:null}},this.init()}$.extend(!0,window,{Slick:{Editors:{Text:TextEditor,Integer:IntegerEditor,Date:DateEditor,YesNoSelect:YesNoSelectEditor,Checkbox:CheckboxEditor,PercentComplete:PercentCompleteEditor,LongText:LongTextEditor}}})}(jQuery),"undefined"==typeof jQuery)throw"SlickGrid requires jquery module to be loaded";if(!jQuery.fn.drag)throw"SlickGrid requires jquery.event.drag module to be loaded";if("undefined"==typeof Slick)throw"slick.core.js not loaded";!function($){function SlickGrid(container,data,columns,options){function init(){if($container=$(container),$container.length<1)throw new Error("SlickGrid requires a valid container, "+container+" does not exist in the DOM.");maxSupportedCssHeight=maxSupportedCssHeight||getMaxSupportedCssHeight(),scrollbarDimensions=scrollbarDimensions||measureScrollbar(),options=$.extend({},defaults,options),validateAndEnforceOptions(),columnDefaults.width=options.defaultColumnWidth,columnsById={};for(var i=0;i<columns.length;i++){var m=columns[i]=$.extend({},columnDefaults,columns[i]);columnsById[m.id]=i,m.minWidth&&m.width<m.minWidth&&(m.width=m.minWidth),m.maxWidth&&m.width>m.maxWidth&&(m.width=m.maxWidth)}if(options.enableColumnReorder&&!$.fn.sortable)throw new Error("SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded");editController={commitCurrentEdit:commitCurrentEdit,cancelCurrentEdit:cancelCurrentEdit},$container.empty().css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget"),/relative|absolute|fixed/.test($container.css("position"))||$container.css("position","relative"),$focusSink=$("<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>").appendTo($container),$headerScroller=$("<div class='slick-header ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$headers=$("<div class='slick-header-columns' style='left:-1000px' />").appendTo($headerScroller),$headers.width(getHeadersWidth()),$headerRowScroller=$("<div class='slick-headerrow ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$headerRow=$("<div class='slick-headerrow-columns' />").appendTo($headerRowScroller),$headerRowSpacer=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($headerRowScroller),$topPanelScroller=$("<div class='slick-top-panel-scroller ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$topPanel=$("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScroller),options.showTopPanel||$topPanelScroller.hide(),options.showHeaderRow||$headerRowScroller.hide(),$viewport=$("<div class='slick-viewport' style='width:100%;overflow:auto;outline:0;position:relative;;'>").appendTo($container),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),$canvas=$("<div class='grid-canvas' />").appendTo($viewport),$focusSink2=$focusSink.clone().appendTo($container),options.explicitInitialization||finishInitialization()}function finishInitialization(){initialized||(initialized=!0,viewportW=parseFloat($.css($container[0],"width",!0)),measureCellPaddingAndBorder(),disableSelection($headers),options.enableTextSelectionOnCells||$viewport.bind("selectstart.ui",function(event){return $(event.target).is("input,textarea")}),updateColumnCaches(),createColumnHeaders(),setupColumnSort(),createCssRules(),resizeCanvas(),bindAncestorScrollEvents(),$container.bind("resize.slickgrid",resizeCanvas),$viewport.bind("scroll",handleScroll),$headerScroller.bind("contextmenu",handleHeaderContextMenu).bind("click",handleHeaderClick).delegate(".slick-header-column","mouseenter",handleHeaderMouseEnter).delegate(".slick-header-column","mouseleave",handleHeaderMouseLeave),$headerRowScroller.bind("scroll",handleHeaderRowScroll),$focusSink.add($focusSink2).bind("keydown",handleKeyDown),$canvas.bind("keydown",handleKeyDown).bind("click",handleClick).bind("dblclick",handleDblClick).bind("contextmenu",handleContextMenu).bind("draginit",handleDragInit).bind("dragstart",{distance:3},handleDragStart).bind("drag",handleDrag).bind("dragend",handleDragEnd).delegate(".slick-cell","mouseenter",handleMouseEnter).delegate(".slick-cell","mouseleave",handleMouseLeave))}function registerPlugin(plugin){plugins.unshift(plugin),plugin.init(self)}function unregisterPlugin(plugin){for(var i=plugins.length;i>=0;i--)if(plugins[i]===plugin){plugins[i].destroy&&plugins[i].destroy(),plugins.splice(i,1);break}}function setSelectionModel(model){selectionModel&&(selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged),selectionModel.destroy&&selectionModel.destroy()),selectionModel=model,selectionModel&&(selectionModel.init(self),selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged))}function getSelectionModel(){return selectionModel}function getCanvasNode(){return $canvas[0]}function measureScrollbar(){var $c=$("<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>").appendTo("body"),dim={width:$c.width()-$c[0].clientWidth,height:$c.height()-$c[0].clientHeight};return $c.remove(),dim}function getHeadersWidth(){for(var headersWidth=0,i=0,ii=columns.length;ii>i;i++){var width=columns[i].width;headersWidth+=width}return headersWidth+=scrollbarDimensions.width,Math.max(headersWidth,viewportW)+1e3}function getCanvasWidth(){for(var availableWidth=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,rowWidth=0,i=columns.length;i--;)rowWidth+=columns[i].width;return options.fullWidthRows?Math.max(rowWidth,availableWidth):rowWidth}function updateCanvasWidth(forceColumnWidthsUpdate){var oldCanvasWidth=canvasWidth;canvasWidth=getCanvasWidth(),canvasWidth!=oldCanvasWidth&&($canvas.width(canvasWidth),$headerRow.width(canvasWidth),$headers.width(getHeadersWidth()),viewportHasHScroll=canvasWidth>viewportW-scrollbarDimensions.width),$headerRowSpacer.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),(canvasWidth!=oldCanvasWidth||forceColumnWidthsUpdate)&&applyColumnWidths()}function disableSelection($target){$target&&$target.jquery&&$target.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function getMaxSupportedCssHeight(){for(var supportedHeight=1e6,testUpTo=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,div=$("<div style='display:none' />").appendTo(document.body);;){var test=2*supportedHeight;if(div.css("height",test),test>testUpTo||div.height()!==test)break;supportedHeight=test}return div.remove(),supportedHeight}function bindAncestorScrollEvents(){for(var elem=$canvas[0];(elem=elem.parentNode)!=document.body&&null!=elem;)if(elem==$viewport[0]||elem.scrollWidth!=elem.clientWidth||elem.scrollHeight!=elem.clientHeight){var $elem=$(elem);$boundAncestors=$boundAncestors?$boundAncestors.add($elem):$elem,$elem.bind("scroll."+uid,handleActiveCellPositionChange)}}function unbindAncestorScrollEvents(){$boundAncestors&&($boundAncestors.unbind("scroll."+uid),$boundAncestors=null)}function updateColumnHeader(columnId,title,toolTip){if(initialized){var idx=getColumnIndex(columnId);if(null!=idx){var columnDef=columns[idx],$header=$headers.children().eq(idx);$header&&(void 0!==title&&(columns[idx].name=title),void 0!==toolTip&&(columns[idx].toolTip=toolTip),trigger(self.onBeforeHeaderCellDestroy,{node:$header[0],column:columnDef}),$header.attr("title",toolTip||"").children().eq(0).html(title),trigger(self.onHeaderCellRendered,{node:$header[0],column:columnDef}))}}}function getHeaderRow(){return $headerRow[0]}function getHeaderRowColumn(columnId){var idx=getColumnIndex(columnId),$header=$headerRow.children().eq(idx);return $header&&$header[0]}function createColumnHeaders(){function onMouseEnter(){$(this).addClass("ui-state-hover")}function onMouseLeave(){$(this).removeClass("ui-state-hover")}$headers.find(".slick-header-column").each(function(){var columnDef=$(this).data("column");columnDef&&trigger(self.onBeforeHeaderCellDestroy,{node:this,column:columnDef})}),$headers.empty(),$headers.width(getHeadersWidth()),$headerRow.find(".slick-headerrow-column").each(function(){var columnDef=$(this).data("column");columnDef&&trigger(self.onBeforeHeaderRowCellDestroy,{node:this,column:columnDef})}),$headerRow.empty();for(var i=0;i<columns.length;i++){var m=columns[i],header=$("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+m.name+"</span>").width(m.width-headerColumnWidthDiff).attr("id",""+uid+m.id).attr("title",m.toolTip||"").data("column",m).addClass(m.headerCssClass||"").appendTo($headers);if((options.enableColumnReorder||m.sortable)&&header.on("mouseenter",onMouseEnter).on("mouseleave",onMouseLeave),m.sortable&&(header.addClass("slick-header-sortable"),header.append("<span class='slick-sort-indicator' />")),trigger(self.onHeaderCellRendered,{node:header[0],column:m}),options.showHeaderRow){var headerRowCell=$("<div class='ui-state-default slick-headerrow-column l"+i+" r"+i+"'></div>").data("column",m).appendTo($headerRow);trigger(self.onHeaderRowCellRendered,{node:headerRowCell[0],column:m})}}setSortColumns(sortColumns),setupColumnResize(),options.enableColumnReorder&&setupColumnReorder()}function setupColumnSort(){$headers.click(function(e){if(e.metaKey=e.metaKey||e.ctrlKey,!$(e.target).hasClass("slick-resizable-handle")){var $col=$(e.target).closest(".slick-header-column");if($col.length){var column=$col.data("column");if(column.sortable){if(!getEditorLock().commitCurrentEdit())return;for(var sortOpts=null,i=0;i<sortColumns.length;i++)if(sortColumns[i].columnId==column.id){sortOpts=sortColumns[i],sortOpts.sortAsc=!sortOpts.sortAsc;break}e.metaKey&&options.multiColumnSort?sortOpts&&sortColumns.splice(i,1):((e.shiftKey||e.metaKey)&&options.multiColumnSort||(sortColumns=[]),sortOpts?0==sortColumns.length&&sortColumns.push(sortOpts):(sortOpts={columnId:column.id,sortAsc:column.defaultSortAsc},sortColumns.push(sortOpts))),setSortColumns(sortColumns),options.multiColumnSort?trigger(self.onSort,{multiColumnSort:!0,sortCols:$.map(sortColumns,function(col){return{sortCol:columns[getColumnIndex(col.columnId)],sortAsc:col.sortAsc}})},e):trigger(self.onSort,{multiColumnSort:!1,sortCol:column,sortAsc:sortOpts.sortAsc},e)}}}})}function setupColumnReorder(){$headers.filter(":ui-sortable").sortable("destroy"),$headers.sortable({containment:"parent",distance:3,axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",forcePlaceholderSize:!0,start:function(e,ui){$(ui.helper).addClass("slick-header-column-active")},beforeStop:function(e,ui){$(ui.helper).removeClass("slick-header-column-active")},stop:function(e){if(!getEditorLock().commitCurrentEdit())return $(this).sortable("cancel"),void 0;for(var reorderedIds=$headers.sortable("toArray"),reorderedColumns=[],i=0;i<reorderedIds.length;i++)reorderedColumns.push(columns[getColumnIndex(reorderedIds[i].replace(uid,""))]);setColumns(reorderedColumns),trigger(self.onColumnsReordered,{}),e.stopPropagation(),setupColumnResize()}})}function setupColumnResize(){var $col,j,c,pageX,columnElements,minPageX,maxPageX,firstResizable,lastResizable;columnElements=$headers.children(),columnElements.find(".slick-resizable-handle").remove(),columnElements.each(function(i){columns[i].resizable&&(void 0===firstResizable&&(firstResizable=i),lastResizable=i)}),void 0!==firstResizable&&columnElements.each(function(i,e){firstResizable>i||options.forceFitColumns&&i>=lastResizable||($col=$(e),$("<div class='slick-resizable-handle' />").appendTo(e).bind("dragstart",function(e){if(!getEditorLock().commitCurrentEdit())return!1;pageX=e.pageX,$(this).parent().addClass("slick-header-column-active");var shrinkLeewayOnRight=null,stretchLeewayOnRight=null;if(columnElements.each(function(i,e){columns[i].previousWidth=$(e).outerWidth()}),options.forceFitColumns)for(shrinkLeewayOnRight=0,stretchLeewayOnRight=0,j=i+1;j<columnElements.length;j++)c=columns[j],c.resizable&&(null!==stretchLeewayOnRight&&(c.maxWidth?stretchLeewayOnRight+=c.maxWidth-c.previousWidth:stretchLeewayOnRight=null),shrinkLeewayOnRight+=c.previousWidth-Math.max(c.minWidth||0,absoluteColumnMinWidth));var shrinkLeewayOnLeft=0,stretchLeewayOnLeft=0;for(j=0;i>=j;j++)c=columns[j],c.resizable&&(null!==stretchLeewayOnLeft&&(c.maxWidth?stretchLeewayOnLeft+=c.maxWidth-c.previousWidth:stretchLeewayOnLeft=null),shrinkLeewayOnLeft+=c.previousWidth-Math.max(c.minWidth||0,absoluteColumnMinWidth));null===shrinkLeewayOnRight&&(shrinkLeewayOnRight=1e5),null===shrinkLeewayOnLeft&&(shrinkLeewayOnLeft=1e5),null===stretchLeewayOnRight&&(stretchLeewayOnRight=1e5),null===stretchLeewayOnLeft&&(stretchLeewayOnLeft=1e5),maxPageX=pageX+Math.min(shrinkLeewayOnRight,stretchLeewayOnLeft),minPageX=pageX-Math.min(shrinkLeewayOnLeft,stretchLeewayOnRight)}).bind("drag",function(e){var actualMinWidth,x,d=Math.min(maxPageX,Math.max(minPageX,e.pageX))-pageX;if(0>d){for(x=d,j=i;j>=0;j--)c=columns[j],c.resizable&&(actualMinWidth=Math.max(c.minWidth||0,absoluteColumnMinWidth),x&&c.previousWidth+x<actualMinWidth?(x+=c.previousWidth-actualMinWidth,c.width=actualMinWidth):(c.width=c.previousWidth+x,x=0));if(options.forceFitColumns)for(x=-d,j=i+1;j<columnElements.length;j++)c=columns[j],c.resizable&&(x&&c.maxWidth&&c.maxWidth-c.previousWidth<x?(x-=c.maxWidth-c.previousWidth,c.width=c.maxWidth):(c.width=c.previousWidth+x,x=0))}else{for(x=d,j=i;j>=0;j--)c=columns[j],c.resizable&&(x&&c.maxWidth&&c.maxWidth-c.previousWidth<x?(x-=c.maxWidth-c.previousWidth,c.width=c.maxWidth):(c.width=c.previousWidth+x,x=0));if(options.forceFitColumns)for(x=-d,j=i+1;j<columnElements.length;j++)c=columns[j],c.resizable&&(actualMinWidth=Math.max(c.minWidth||0,absoluteColumnMinWidth),x&&c.previousWidth+x<actualMinWidth?(x+=c.previousWidth-actualMinWidth,c.width=actualMinWidth):(c.width=c.previousWidth+x,x=0))}applyColumnHeaderWidths(),options.syncColumnCellResize&&applyColumnWidths()}).bind("dragend",function(){var newWidth;for($(this).parent().removeClass("slick-header-column-active"),j=0;j<columnElements.length;j++)c=columns[j],newWidth=$(columnElements[j]).outerWidth(),c.previousWidth!==newWidth&&c.rerenderOnResize&&invalidateAllRows();updateCanvasWidth(!0),render(),trigger(self.onColumnsResized,{})}))})}function getVBoxDelta($el){var p=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],delta=0;return $.each(p,function(n,val){delta+=parseFloat($el.css(val))||0}),delta}function measureCellPaddingAndBorder(){var el,h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],v=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];el=$("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers),headerColumnWidthDiff=headerColumnHeightDiff=0,$.each(h,function(n,val){headerColumnWidthDiff+=parseFloat(el.css(val))||0}),$.each(v,function(n,val){headerColumnHeightDiff+=parseFloat(el.css(val))||0}),el.remove();var r=$("<div class='slick-row' />").appendTo($canvas);el=$("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(r),cellWidthDiff=cellHeightDiff=0,$.each(h,function(n,val){cellWidthDiff+=parseFloat(el.css(val))||0}),$.each(v,function(n,val){cellHeightDiff+=parseFloat(el.css(val))||0}),r.remove(),absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=$("<style type='text/css' rel='stylesheet' />").appendTo($("head"));for(var rowHeight=options.rowHeight-cellHeightDiff,rules=["."+uid+" .slick-header-column { left: 1000px; }","."+uid+" .slick-top-panel { height:"+options.topPanelHeight+"px; }","."+uid+" .slick-headerrow-columns { height:"+options.headerRowHeight+"px; }","."+uid+" .slick-cell { height:"+rowHeight+"px; }","."+uid+" .slick-row { height:"+options.rowHeight+"px; }"],i=0;i<columns.length;i++)rules.push("."+uid+" .l"+i+" { }"),rules.push("."+uid+" .r"+i+" { }");$style[0].styleSheet?$style[0].styleSheet.cssText=rules.join(" "):$style[0].appendChild(document.createTextNode(rules.join(" ")))}function getColumnCssRules(idx){if(!stylesheet){for(var sheets=document.styleSheets,i=0;i<sheets.length;i++)if((sheets[i].ownerNode||sheets[i].owningElement)==$style[0]){stylesheet=sheets[i];break}if(!stylesheet)throw new Error("Cannot find stylesheet.");columnCssRulesL=[],columnCssRulesR=[];for(var matches,columnIdx,cssRules=stylesheet.cssRules||stylesheet.rules,i=0;i<cssRules.length;i++){var selector=cssRules[i].selectorText;(matches=/\.l\d+/.exec(selector))?(columnIdx=parseInt(matches[0].substr(2,matches[0].length-2),10),columnCssRulesL[columnIdx]=cssRules[i]):(matches=/\.r\d+/.exec(selector))&&(columnIdx=parseInt(matches[0].substr(2,matches[0].length-2),10),columnCssRulesR[columnIdx]=cssRules[i])}}return{left:columnCssRulesL[idx],right:columnCssRulesR[idx]}}function removeCssRules(){$style.remove(),stylesheet=null}function destroy(){getEditorLock().cancelCurrentEdit(),trigger(self.onBeforeDestroy,{});for(var i=plugins.length;i--;)unregisterPlugin(plugins[i]);options.enableColumnReorder&&$headers.filter(":ui-sortable").sortable("destroy"),unbindAncestorScrollEvents(),$container.unbind(".slickgrid"),removeCssRules(),$canvas.unbind("draginit dragstart dragend drag"),$container.empty().removeClass(uid)}function trigger(evt,args,e){return e=e||new Slick.EventData,args=args||{},args.grid=self,evt.notify(args,e,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(id){return columnsById[id]}function autosizeColumns(){var i,c,prevTotal,widths=[],shrinkLeeway=0,total=0,availWidth=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;
for(i=0;i<columns.length;i++)c=columns[i],widths.push(c.width),total+=c.width,c.resizable&&(shrinkLeeway+=c.width-Math.max(c.minWidth,absoluteColumnMinWidth));for(prevTotal=total;total>availWidth&&shrinkLeeway;){var shrinkProportion=(total-availWidth)/shrinkLeeway;for(i=0;i<columns.length&&total>availWidth;i++){c=columns[i];var width=widths[i];if(!(!c.resizable||width<=c.minWidth||absoluteColumnMinWidth>=width)){var absMinWidth=Math.max(c.minWidth,absoluteColumnMinWidth),shrinkSize=Math.floor(shrinkProportion*(width-absMinWidth))||1;shrinkSize=Math.min(shrinkSize,width-absMinWidth),total-=shrinkSize,shrinkLeeway-=shrinkSize,widths[i]-=shrinkSize}}if(prevTotal==total)break;prevTotal=total}for(prevTotal=total;availWidth>total;){var growProportion=availWidth/total;for(i=0;i<columns.length&&availWidth>total;i++)if(c=columns[i],c.resizable&&!(c.maxWidth<=c.width)){var growSize=Math.min(Math.floor(growProportion*c.width)-c.width,c.maxWidth-c.width||1e6)||1;total+=growSize,widths[i]+=growSize}if(prevTotal==total)break;prevTotal=total}var reRender=!1;for(i=0;i<columns.length;i++)columns[i].rerenderOnResize&&columns[i].width!=widths[i]&&(reRender=!0),columns[i].width=widths[i];applyColumnHeaderWidths(),updateCanvasWidth(!0),reRender&&(invalidateAllRows(),render())}function applyColumnHeaderWidths(){if(initialized){for(var h,i=0,headers=$headers.children(),ii=headers.length;ii>i;i++)h=$(headers[i]),h.width()!==columns[i].width-headerColumnWidthDiff&&h.width(columns[i].width-headerColumnWidthDiff);updateColumnCaches()}}function applyColumnWidths(){for(var w,rule,x=0,i=0;i<columns.length;i++)w=columns[i].width,rule=getColumnCssRules(i),rule.left.style.left=x+"px",rule.right.style.right=canvasWidth-x-w+"px",x+=columns[i].width}function setSortColumn(columnId,ascending){setSortColumns([{columnId:columnId,sortAsc:ascending}])}function setSortColumns(cols){sortColumns=cols;var headerColumnEls=$headers.children();headerColumnEls.removeClass("slick-header-column-sorted").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc"),$.each(sortColumns,function(i,col){null==col.sortAsc&&(col.sortAsc=!0);var columnIndex=getColumnIndex(col.columnId);null!=columnIndex&&headerColumnEls.eq(columnIndex).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(col.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc")})}function getSortColumns(){return sortColumns}function handleSelectedRangesChanged(e,ranges){selectedRows=[];for(var hash={},i=0;i<ranges.length;i++)for(var j=ranges[i].fromRow;j<=ranges[i].toRow;j++){hash[j]||(selectedRows.push(j),hash[j]={});for(var k=ranges[i].fromCell;k<=ranges[i].toCell;k++)canCellBeSelected(j,k)&&(hash[j][columns[k].id]=options.selectedCellCssClass)}setCellCssStyles(options.selectedCellCssClass,hash),trigger(self.onSelectedRowsChanged,{rows:getSelectedRows()},e)}function getColumns(){return columns}function updateColumnCaches(){columnPosLeft=[],columnPosRight=[];for(var x=0,i=0,ii=columns.length;ii>i;i++)columnPosLeft[i]=x,columnPosRight[i]=x+columns[i].width,x+=columns[i].width}function setColumns(columnDefinitions){columns=columnDefinitions,columnsById={};for(var i=0;i<columns.length;i++){var m=columns[i]=$.extend({},columnDefaults,columns[i]);columnsById[m.id]=i,m.minWidth&&m.width<m.minWidth&&(m.width=m.minWidth),m.maxWidth&&m.width>m.maxWidth&&(m.width=m.maxWidth)}updateColumnCaches(),initialized&&(invalidateAllRows(),createColumnHeaders(),removeCssRules(),createCssRules(),resizeCanvas(),applyColumnWidths(),handleScroll())}function getOptions(){return options}function setOptions(args){getEditorLock().commitCurrentEdit()&&(makeActiveCellNormal(),options.enableAddRow!==args.enableAddRow&&invalidateRow(getDataLength()),options=$.extend(options,args),validateAndEnforceOptions(),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),render())}function validateAndEnforceOptions(){options.autoHeight&&(options.leaveSpaceForNewRows=!1)}function setData(newData,scrollToTop){data=newData,invalidateAllRows(),updateRowCount(),scrollToTop&&scrollTo(0)}function getData(){return data}function getDataLength(){return data.getLength?data.getLength():data.length}function getDataItem(i){return data.getItem?data.getItem(i):data[i]}function getTopPanel(){return $topPanel[0]}function setTopPanelVisibility(visible){options.showTopPanel!=visible&&(options.showTopPanel=visible,visible?$topPanelScroller.slideDown("fast",resizeCanvas):$topPanelScroller.slideUp("fast",resizeCanvas))}function setHeaderRowVisibility(visible){options.showHeaderRow!=visible&&(options.showHeaderRow=visible,visible?$headerRowScroller.slideDown("fast",resizeCanvas):$headerRowScroller.slideUp("fast",resizeCanvas))}function getContainerNode(){return $container.get(0)}function getRowTop(row){return options.rowHeight*row-offset}function getRowFromPosition(y){return Math.floor((y+offset)/options.rowHeight)}function scrollTo(y){y=Math.max(y,0),y=Math.min(y,th-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0));var oldOffset=offset;page=Math.min(n-1,Math.floor(y/ph)),offset=Math.round(page*cj);var newScrollTop=y-offset;if(offset!=oldOffset){var range=getVisibleRange(newScrollTop);cleanupRows(range),updateRowPositions()}prevScrollTop!=newScrollTop&&(vScrollDir=newScrollTop+offset>prevScrollTop+oldOffset?1:-1,$viewport[0].scrollTop=lastRenderedScrollTop=scrollTop=prevScrollTop=newScrollTop,trigger(self.onViewportChanged,{}))}function defaultFormatter(row,cell,value){return null==value?"":(value+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getFormatter(row,column){var rowMetadata=data.getItemMetadata&&data.getItemMetadata(row),columnOverrides=rowMetadata&&rowMetadata.columns&&(rowMetadata.columns[column.id]||rowMetadata.columns[getColumnIndex(column.id)]);return columnOverrides&&columnOverrides.formatter||rowMetadata&&rowMetadata.formatter||column.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(column)||options.defaultFormatter}function getEditor(row,cell){var column=columns[cell],rowMetadata=data.getItemMetadata&&data.getItemMetadata(row),columnMetadata=rowMetadata&&rowMetadata.columns;return columnMetadata&&columnMetadata[column.id]&&void 0!==columnMetadata[column.id].editor?columnMetadata[column.id].editor:columnMetadata&&columnMetadata[cell]&&void 0!==columnMetadata[cell].editor?columnMetadata[cell].editor:column.editor||options.editorFactory&&options.editorFactory.getEditor(column)}function getDataItemValueForColumn(item,columnDef){return options.dataItemColumnValueExtractor?options.dataItemColumnValueExtractor(item,columnDef):item[columnDef.field]}function appendRowHtml(stringArray,row,range){var d=getDataItem(row),dataLoading=row<getDataLength()&&!d,rowCss="slick-row"+(dataLoading?" loading":"")+(row===activeRow?" active":"")+(1==row%2?" odd":" even"),metadata=data.getItemMetadata&&data.getItemMetadata(row);metadata&&metadata.cssClasses&&(rowCss+=" "+metadata.cssClasses),stringArray.push("<div class='ui-widget-content "+rowCss+"' style='top:"+getRowTop(row)+"px'>");for(var colspan,m,i=0,ii=columns.length;ii>i;i++){if(m=columns[i],colspan=1,metadata&&metadata.columns){var columnData=metadata.columns[m.id]||metadata.columns[i];colspan=columnData&&columnData.colspan||1,"*"===colspan&&(colspan=ii-i)}if(columnPosRight[Math.min(ii-1,i+colspan-1)]>range.leftPx){if(columnPosLeft[i]>range.rightPx)break;appendCellHtml(stringArray,row,i,colspan)}colspan>1&&(i+=colspan-1)}stringArray.push("</div>")}function appendCellHtml(stringArray,row,cell,colspan){var m=columns[cell],d=getDataItem(row),cellCss="slick-cell l"+cell+" r"+Math.min(columns.length-1,cell+colspan-1)+(m.cssClass?" "+m.cssClass:"");row===activeRow&&cell===activeCell&&(cellCss+=" active");for(var key in cellCssClasses)cellCssClasses[key][row]&&cellCssClasses[key][row][m.id]&&(cellCss+=" "+cellCssClasses[key][row][m.id]);if(stringArray.push("<div class='"+cellCss+"'>"),d){var value=getDataItemValueForColumn(d,m);stringArray.push(getFormatter(row,m)(row,cell,value,m,d))}stringArray.push("</div>"),rowsCache[row].cellRenderQueue.push(cell),rowsCache[row].cellColSpans[cell]=colspan}function cleanupRows(rangeToKeep){for(var i in rowsCache)(i=parseInt(i,10))!==activeRow&&(i<rangeToKeep.top||i>rangeToKeep.bottom)&&removeRowFromCache(i)}function invalidate(){updateRowCount(),invalidateAllRows(),render()}function invalidateAllRows(){currentEditor&&makeActiveCellNormal();for(var row in rowsCache)removeRowFromCache(row)}function removeRowFromCache(row){var cacheEntry=rowsCache[row];cacheEntry&&($canvas[0].removeChild(cacheEntry.rowNode),delete rowsCache[row],delete postProcessedRows[row],renderedRows--,counter_rows_removed++)}function invalidateRows(rows){var i,rl;if(rows&&rows.length)for(vScrollDir=0,i=0,rl=rows.length;rl>i;i++)currentEditor&&activeRow===rows[i]&&makeActiveCellNormal(),rowsCache[rows[i]]&&removeRowFromCache(rows[i])}function invalidateRow(row){invalidateRows([row])}function updateCell(row,cell){var cellNode=getCellNode(row,cell);if(cellNode){var m=columns[cell],d=getDataItem(row);currentEditor&&activeRow===row&&activeCell===cell?currentEditor.loadValue(d):(cellNode.innerHTML=d?getFormatter(row,m)(row,cell,getDataItemValueForColumn(d,m),m,d):"",invalidatePostProcessingResults(row))}}function updateRow(row){var cacheEntry=rowsCache[row];if(cacheEntry){ensureCellNodesInRowsCache(row);for(var columnIdx in cacheEntry.cellNodesByColumnIdx)if(cacheEntry.cellNodesByColumnIdx.hasOwnProperty(columnIdx)){columnIdx=0|columnIdx;var m=columns[columnIdx],d=getDataItem(row),node=cacheEntry.cellNodesByColumnIdx[columnIdx];row===activeRow&&columnIdx===activeCell&&currentEditor?currentEditor.loadValue(d):node.innerHTML=d?getFormatter(row,m)(row,columnIdx,getDataItemValueForColumn(d,m),m,d):""}invalidatePostProcessingResults(row)}}function getViewportHeight(){return parseFloat($.css($container[0],"height",!0))-parseFloat($.css($container[0],"paddingTop",!0))-parseFloat($.css($container[0],"paddingBottom",!0))-parseFloat($.css($headerScroller[0],"height"))-getVBoxDelta($headerScroller)-(options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0)-(options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0)}function resizeCanvas(){initialized&&(viewportH=options.autoHeight?options.rowHeight*(getDataLength()+(options.enableAddRow?1:0)):getViewportHeight(),numVisibleRows=Math.ceil(viewportH/options.rowHeight),viewportW=parseFloat($.css($container[0],"width",!0)),options.autoHeight||$viewport.height(viewportH),options.forceFitColumns&&autosizeColumns(),updateRowCount(),handleScroll(),render())}function updateRowCount(){if(initialized){numberOfRows=getDataLength()+(options.enableAddRow?1:0)+(options.leaveSpaceForNewRows?numVisibleRows-1:0);var oldViewportHasVScroll=viewportHasVScroll;viewportHasVScroll=!options.autoHeight&&numberOfRows*options.rowHeight>viewportH;var l=options.enableAddRow?getDataLength():getDataLength()-1;for(var i in rowsCache)i>=l&&removeRowFromCache(i);activeCellNode&&activeRow>l&&resetActiveCell();var oldH=h;th=Math.max(options.rowHeight*numberOfRows,viewportH-scrollbarDimensions.height),maxSupportedCssHeight>th?(h=ph=th,n=1,cj=0):(h=maxSupportedCssHeight,ph=h/100,n=Math.floor(th/ph),cj=(th-h)/(n-1)),h!==oldH&&($canvas.css("height",h),scrollTop=$viewport[0].scrollTop);var oldScrollTopInRange=th-viewportH>=scrollTop+offset;0==th||0==scrollTop?page=offset=0:oldScrollTopInRange?scrollTo(scrollTop+offset):scrollTo(th-viewportH),h!=oldH&&options.autoHeight&&resizeCanvas(),options.forceFitColumns&&oldViewportHasVScroll!=viewportHasVScroll&&autosizeColumns(),updateCanvasWidth(!1)}}function getVisibleRange(viewportTop,viewportLeft){return null==viewportTop&&(viewportTop=scrollTop),null==viewportLeft&&(viewportLeft=scrollLeft),{top:getRowFromPosition(viewportTop),bottom:getRowFromPosition(viewportTop+viewportH)+1,leftPx:viewportLeft,rightPx:viewportLeft+viewportW}}function getRenderedRange(viewportTop,viewportLeft){var range=getVisibleRange(viewportTop,viewportLeft),buffer=Math.round(viewportH/options.rowHeight),minBuffer=3;return-1==vScrollDir?(range.top-=buffer,range.bottom+=minBuffer):1==vScrollDir?(range.top-=minBuffer,range.bottom+=buffer):(range.top-=minBuffer,range.bottom+=minBuffer),range.top=Math.max(0,range.top),range.bottom=Math.min(options.enableAddRow?getDataLength():getDataLength()-1,range.bottom),range.leftPx-=viewportW,range.rightPx+=viewportW,range.leftPx=Math.max(0,range.leftPx),range.rightPx=Math.min(canvasWidth,range.rightPx),range}function ensureCellNodesInRowsCache(row){var cacheEntry=rowsCache[row];if(cacheEntry&&cacheEntry.cellRenderQueue.length)for(var lastChild=cacheEntry.rowNode.lastChild;cacheEntry.cellRenderQueue.length;){var columnIdx=cacheEntry.cellRenderQueue.pop();cacheEntry.cellNodesByColumnIdx[columnIdx]=lastChild,lastChild=lastChild.previousSibling}}function cleanUpCells(range,row){var totalCellsRemoved=0,cacheEntry=rowsCache[row],cellsToRemove=[];for(var i in cacheEntry.cellNodesByColumnIdx)if(cacheEntry.cellNodesByColumnIdx.hasOwnProperty(i)){i=0|i;var colspan=cacheEntry.cellColSpans[i];(columnPosLeft[i]>range.rightPx||columnPosRight[Math.min(columns.length-1,i+colspan-1)]<range.leftPx)&&(row!=activeRow||i!=activeCell)&&cellsToRemove.push(i)}for(var cellToRemove;null!=(cellToRemove=cellsToRemove.pop());)cacheEntry.rowNode.removeChild(cacheEntry.cellNodesByColumnIdx[cellToRemove]),delete cacheEntry.cellColSpans[cellToRemove],delete cacheEntry.cellNodesByColumnIdx[cellToRemove],postProcessedRows[row]&&delete postProcessedRows[row][cellToRemove],totalCellsRemoved++}function cleanUpAndRenderCells(range){for(var cacheEntry,cellsAdded,colspan,stringArray=[],processedRows=[],totalCellsAdded=0,row=range.top;row<=range.bottom;row++)if(cacheEntry=rowsCache[row]){ensureCellNodesInRowsCache(row),cleanUpCells(range,row),cellsAdded=0;var metadata=data.getItemMetadata&&data.getItemMetadata(row);metadata=metadata&&metadata.columns;for(var i=0,ii=columns.length;ii>i&&!(columnPosLeft[i]>range.rightPx);i++)if(null==(colspan=cacheEntry.cellColSpans[i])){if(colspan=1,metadata){var columnData=metadata[columns[i].id]||metadata[i];colspan=columnData&&columnData.colspan||1,"*"===colspan&&(colspan=ii-i)}columnPosRight[Math.min(ii-1,i+colspan-1)]>range.leftPx&&(appendCellHtml(stringArray,row,i,colspan),cellsAdded++),i+=colspan>1?colspan-1:0}else i+=colspan>1?colspan-1:0;cellsAdded&&(totalCellsAdded+=cellsAdded,processedRows.push(row))}if(stringArray.length){var x=document.createElement("div");x.innerHTML=stringArray.join("");for(var processedRow,node;null!=(processedRow=processedRows.pop());){cacheEntry=rowsCache[processedRow];for(var columnIdx;null!=(columnIdx=cacheEntry.cellRenderQueue.pop());)node=x.lastChild,cacheEntry.rowNode.appendChild(node),cacheEntry.cellNodesByColumnIdx[columnIdx]=node}}}function renderRows(range){for(var parentNode=$canvas[0],stringArray=[],rows=[],needToReselectCell=!1,i=range.top;i<=range.bottom;i++)rowsCache[i]||(renderedRows++,rows.push(i),rowsCache[i]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},appendRowHtml(stringArray,i,range),activeCellNode&&activeRow===i&&(needToReselectCell=!0),counter_rows_rendered++);if(rows.length){var x=document.createElement("div");x.innerHTML=stringArray.join("");for(var i=0,ii=rows.length;ii>i;i++)rowsCache[rows[i]].rowNode=parentNode.appendChild(x.firstChild);needToReselectCell&&(activeCellNode=getCellNode(activeRow,activeCell))}}function startPostProcessing(){options.enableAsyncPostRender&&(clearTimeout(h_postrender),h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}function invalidatePostProcessingResults(row){delete postProcessedRows[row],postProcessFromRow=Math.min(postProcessFromRow,row),postProcessToRow=Math.max(postProcessToRow,row),startPostProcessing()}function updateRowPositions(){for(var row in rowsCache)rowsCache[row].rowNode.style.top=getRowTop(row)+"px"}function render(){if(initialized){var visible=getVisibleRange(),rendered=getRenderedRange();cleanupRows(rendered),lastRenderedScrollLeft!=scrollLeft&&cleanUpAndRenderCells(rendered),renderRows(rendered),postProcessFromRow=visible.top,postProcessToRow=Math.min(options.enableAddRow?getDataLength():getDataLength()-1,visible.bottom),startPostProcessing(),lastRenderedScrollTop=scrollTop,lastRenderedScrollLeft=scrollLeft,h_render=null}}function handleHeaderRowScroll(){var scrollLeft=$headerRowScroller[0].scrollLeft;scrollLeft!=$viewport[0].scrollLeft&&($viewport[0].scrollLeft=scrollLeft)}function handleScroll(){scrollTop=$viewport[0].scrollTop,scrollLeft=$viewport[0].scrollLeft;var vScrollDist=Math.abs(scrollTop-prevScrollTop),hScrollDist=Math.abs(scrollLeft-prevScrollLeft);if(hScrollDist&&(prevScrollLeft=scrollLeft,$headerScroller[0].scrollLeft=scrollLeft,$topPanelScroller[0].scrollLeft=scrollLeft,$headerRowScroller[0].scrollLeft=scrollLeft),vScrollDist)if(vScrollDir=scrollTop>prevScrollTop?1:-1,prevScrollTop=scrollTop,viewportH>vScrollDist)scrollTo(scrollTop+offset);else{var oldOffset=offset;page=h==viewportH?0:Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph))),offset=Math.round(page*cj),oldOffset!=offset&&invalidateAllRows()}(hScrollDist||vScrollDist)&&(h_render&&clearTimeout(h_render),(Math.abs(lastRenderedScrollTop-scrollTop)>20||Math.abs(lastRenderedScrollLeft-scrollLeft)>20)&&(options.forceSyncScrolling||Math.abs(lastRenderedScrollTop-scrollTop)<viewportH&&Math.abs(lastRenderedScrollLeft-scrollLeft)<viewportW?render():h_render=setTimeout(render,50),trigger(self.onViewportChanged,{}))),trigger(self.onScroll,{scrollLeft:scrollLeft,scrollTop:scrollTop})}function asyncPostProcessRows(){for(;postProcessToRow>=postProcessFromRow;){var row=vScrollDir>=0?postProcessFromRow++:postProcessToRow--,cacheEntry=rowsCache[row];if(cacheEntry&&!(row>=getDataLength())){postProcessedRows[row]||(postProcessedRows[row]={}),ensureCellNodesInRowsCache(row);for(var columnIdx in cacheEntry.cellNodesByColumnIdx)if(cacheEntry.cellNodesByColumnIdx.hasOwnProperty(columnIdx)){columnIdx=0|columnIdx;var m=columns[columnIdx];if(m.asyncPostRender&&!postProcessedRows[row][columnIdx]){var node=cacheEntry.cellNodesByColumnIdx[columnIdx];node&&m.asyncPostRender(node,row,getDataItem(row),m),postProcessedRows[row][columnIdx]=!0}}return h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay),void 0}}}function updateCellCssStylesOnRenderedRows(addedHash,removedHash){var node,columnId,addedRowHash,removedRowHash;for(var row in rowsCache){if(removedRowHash=removedHash&&removedHash[row],addedRowHash=addedHash&&addedHash[row],removedRowHash)for(columnId in removedRowHash)addedRowHash&&removedRowHash[columnId]==addedRowHash[columnId]||(node=getCellNode(row,getColumnIndex(columnId)),node&&$(node).removeClass(removedRowHash[columnId]));if(addedRowHash)for(columnId in addedRowHash)removedRowHash&&removedRowHash[columnId]==addedRowHash[columnId]||(node=getCellNode(row,getColumnIndex(columnId)),node&&$(node).addClass(addedRowHash[columnId]))}}function addCellCssStyles(key,hash){if(cellCssClasses[key])throw"addCellCssStyles: cell CSS hash with key '"+key+"' already exists.";cellCssClasses[key]=hash,updateCellCssStylesOnRenderedRows(hash,null),trigger(self.onCellCssStylesChanged,{key:key,hash:hash})}function removeCellCssStyles(key){cellCssClasses[key]&&(updateCellCssStylesOnRenderedRows(null,cellCssClasses[key]),delete cellCssClasses[key],trigger(self.onCellCssStylesChanged,{key:key,hash:null}))}function setCellCssStyles(key,hash){var prevHash=cellCssClasses[key];cellCssClasses[key]=hash,updateCellCssStylesOnRenderedRows(hash,prevHash),trigger(self.onCellCssStylesChanged,{key:key,hash:hash})}function getCellCssStyles(key){return cellCssClasses[key]}function flashCell(row,cell,speed){function toggleCellClass(times){times&&setTimeout(function(){$cell.queue(function(){$cell.toggleClass(options.cellFlashingCssClass).dequeue(),toggleCellClass(times-1)})},speed)}if(speed=speed||100,rowsCache[row]){var $cell=$(getCellNode(row,cell));toggleCellClass(4)}}function handleDragInit(e,dd){var cell=getCellFromEvent(e);if(!cell||!cellExists(cell.row,cell.cell))return!1;var retval=trigger(self.onDragInit,dd,e);return e.isImmediatePropagationStopped()?retval:!1}function handleDragStart(e,dd){var cell=getCellFromEvent(e);if(!cell||!cellExists(cell.row,cell.cell))return!1;var retval=trigger(self.onDragStart,dd,e);return e.isImmediatePropagationStopped()?retval:!1}function handleDrag(e,dd){return trigger(self.onDrag,dd,e)}function handleDragEnd(e,dd){trigger(self.onDragEnd,dd,e)}function handleKeyDown(e){trigger(self.onKeyDown,{row:activeRow,cell:activeCell},e);var handled=e.isImmediatePropagationStopped();if(!handled)if(e.shiftKey||e.altKey||e.ctrlKey)9!=e.which||!e.shiftKey||e.ctrlKey||e.altKey||(handled=navigatePrev());else if(27==e.which){if(!getEditorLock().isActive())return;cancelEditAndSetFocus()}else 37==e.which?handled=navigateLeft():39==e.which?handled=navigateRight():38==e.which?handled=navigateUp():40==e.which?handled=navigateDown():9==e.which?handled=navigateNext():13==e.which&&(options.editable&&(currentEditor?activeRow===getDataLength()?navigateDown():commitEditAndSetFocus():getEditorLock().commitCurrentEdit()&&makeActiveCellEditable()),handled=!0);if(handled){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(error){}}}function handleClick(e){currentEditor||e.target!=document.activeElement&&setFocus();var cell=getCellFromEvent(e);!cell||null!==currentEditor&&activeRow==cell.row&&activeCell==cell.cell||(trigger(self.onClick,{row:cell.row,cell:cell.cell},e),e.isImmediatePropagationStopped()||activeCell==cell.cell&&activeRow==cell.row||!canCellBeActive(cell.row,cell.cell)||(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit())&&(scrollRowIntoView(cell.row,!1),setActiveCellInternal(getCellNode(cell.row,cell.cell),cell.row===getDataLength()||options.autoEdit)))}function handleContextMenu(e){var $cell=$(e.target).closest(".slick-cell",$canvas);0!==$cell.length&&(activeCellNode!==$cell[0]||null===currentEditor)&&trigger(self.onContextMenu,{},e)}function handleDblClick(e){var cell=getCellFromEvent(e);!cell||null!==currentEditor&&activeRow==cell.row&&activeCell==cell.cell||(trigger(self.onDblClick,{row:cell.row,cell:cell.cell},e),e.isImmediatePropagationStopped()||options.editable&&gotoCell(cell.row,cell.cell,!0))}function handleHeaderMouseEnter(e){trigger(self.onHeaderMouseEnter,{column:$(this).data("column")},e)}function handleHeaderMouseLeave(e){trigger(self.onHeaderMouseLeave,{column:$(this).data("column")},e)}function handleHeaderContextMenu(e){var $header=$(e.target).closest(".slick-header-column",".slick-header-columns"),column=$header&&$header.data("column");trigger(self.onHeaderContextMenu,{column:column},e)}function handleHeaderClick(e){var $header=$(e.target).closest(".slick-header-column",".slick-header-columns"),column=$header&&$header.data("column");column&&trigger(self.onHeaderClick,{column:column},e)}function handleMouseEnter(e){trigger(self.onMouseEnter,{},e)}function handleMouseLeave(e){trigger(self.onMouseLeave,{},e)}function cellExists(row,cell){return!(0>row||row>=getDataLength()||0>cell||cell>=columns.length)}function getCellFromPoint(x,y){for(var row=getRowFromPosition(y),cell=0,w=0,i=0;i<columns.length&&x>w;i++)w+=columns[i].width,cell++;return 0>cell&&(cell=0),{row:row,cell:cell-1}}function getCellFromNode(cellNode){var cls=/l\d+/.exec(cellNode.className);if(!cls)throw"getCellFromNode: cannot get cell - "+cellNode.className;return parseInt(cls[0].substr(1,cls[0].length-1),10)}function getRowFromNode(rowNode){for(var row in rowsCache)if(rowsCache[row].rowNode===rowNode)return 0|row;return null}function getCellFromEvent(e){var $cell=$(e.target).closest(".slick-cell",$canvas);if(!$cell.length)return null;var row=getRowFromNode($cell[0].parentNode),cell=getCellFromNode($cell[0]);return null==row||null==cell?null:{row:row,cell:cell}}function getCellNodeBox(row,cell){if(!cellExists(row,cell))return null;for(var y1=getRowTop(row),y2=y1+options.rowHeight-1,x1=0,i=0;cell>i;i++)x1+=columns[i].width;var x2=x1+columns[cell].width;return{top:y1,left:x1,bottom:y2,right:x2}}function resetActiveCell(){setActiveCellInternal(null,!1)}function setFocus(){-1==tabbingDirection?$focusSink[0].focus():$focusSink2[0].focus()}function scrollCellIntoView(row,cell,doPaging){scrollRowIntoView(row,doPaging);var colspan=getColspan(row,cell),left=columnPosLeft[cell],right=columnPosRight[cell+(colspan>1?colspan-1:0)],scrollRight=scrollLeft+viewportW;scrollLeft>left?($viewport.scrollLeft(left),handleScroll(),render()):right>scrollRight&&($viewport.scrollLeft(Math.min(left,right-$viewport[0].clientWidth)),handleScroll(),render())}function setActiveCellInternal(newCell,editMode){null!==activeCellNode&&(makeActiveCellNormal(),$(activeCellNode).removeClass("active"),rowsCache[activeRow]&&$(rowsCache[activeRow].rowNode).removeClass("active"));var activeCellChanged=activeCellNode!==newCell;activeCellNode=newCell,null!=activeCellNode?(activeRow=getRowFromNode(activeCellNode.parentNode),activeCell=activePosX=getCellFromNode(activeCellNode),$(activeCellNode).addClass("active"),$(rowsCache[activeRow].rowNode).addClass("active"),options.editable&&editMode&&isCellPotentiallyEditable(activeRow,activeCell)&&(clearTimeout(h_editorLoader),options.asyncEditorLoading?h_editorLoader=setTimeout(function(){makeActiveCellEditable()},options.asyncEditorLoadDelay):makeActiveCellEditable())):activeRow=activeCell=null,activeCellChanged&&trigger(self.onActiveCellChanged,getActiveCell())}function clearTextSelection(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var sel=window.getSelection();sel&&sel.removeAllRanges&&sel.removeAllRanges()}}function isCellPotentiallyEditable(row,cell){return row<getDataLength()&&!getDataItem(row)?!1:columns[cell].cannotTriggerInsert&&row>=getDataLength()?!1:getEditor(row,cell)?!0:!1}function makeActiveCellNormal(){if(currentEditor){if(trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor}),currentEditor.destroy(),currentEditor=null,activeCellNode){var d=getDataItem(activeRow);if($(activeCellNode).removeClass("editable invalid"),d){var column=columns[activeCell],formatter=getFormatter(activeRow,column);activeCellNode.innerHTML=formatter(activeRow,activeCell,getDataItemValueForColumn(d,column),column,getDataItem(activeRow)),invalidatePostProcessingResults(activeRow)}}navigator.userAgent.toLowerCase().match(/msie/)&&clearTextSelection(),getEditorLock().deactivate(editController)}}function makeActiveCellEditable(editor){if(activeCellNode){if(!options.editable)throw"Grid : makeActiveCellEditable : should never get called when options.editable is false";if(clearTimeout(h_editorLoader),isCellPotentiallyEditable(activeRow,activeCell)){var columnDef=columns[activeCell],item=getDataItem(activeRow);if(trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:item,column:columnDef})===!1)return setFocus(),void 0;getEditorLock().activate(editController),$(activeCellNode).addClass("editable"),editor||(activeCellNode.innerHTML=""),currentEditor=new(editor||getEditor(activeRow,activeCell))({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:columnDef,item:item||{},commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus}),item&&currentEditor.loadValue(item),serializedEditorValue=currentEditor.serializeValue(),currentEditor.position&&handleActiveCellPositionChange()}}}function commitEditAndSetFocus(){getEditorLock().commitCurrentEdit()&&(setFocus(),options.autoEdit&&navigateDown())}function cancelEditAndSetFocus(){getEditorLock().cancelCurrentEdit()&&setFocus()}function absBox(elem){var box={top:elem.offsetTop,left:elem.offsetLeft,bottom:0,right:0,width:$(elem).outerWidth(),height:$(elem).outerHeight(),visible:!0};box.bottom=box.top+box.height,box.right=box.left+box.width;for(var offsetParent=elem.offsetParent;(elem=elem.parentNode)!=document.body;)box.visible&&elem.scrollHeight!=elem.offsetHeight&&"visible"!=$(elem).css("overflowY")&&(box.visible=box.bottom>elem.scrollTop&&box.top<elem.scrollTop+elem.clientHeight),box.visible&&elem.scrollWidth!=elem.offsetWidth&&"visible"!=$(elem).css("overflowX")&&(box.visible=box.right>elem.scrollLeft&&box.left<elem.scrollLeft+elem.clientWidth),box.left-=elem.scrollLeft,box.top-=elem.scrollTop,elem===offsetParent&&(box.left+=elem.offsetLeft,box.top+=elem.offsetTop,offsetParent=elem.offsetParent),box.bottom=box.top+box.height,box.right=box.left+box.width;return box}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(activeCellNode&&(trigger(self.onActiveCellPositionChanged,{}),currentEditor)){var cellBox=getActiveCellPosition();currentEditor.show&&currentEditor.hide&&(cellBox.visible?currentEditor.show():currentEditor.hide()),currentEditor.position&&currentEditor.position(cellBox)}}function getCellEditor(){return currentEditor}function getActiveCell(){return activeCellNode?{row:activeRow,cell:activeCell}:null}function getActiveCellNode(){return activeCellNode}function scrollRowIntoView(row,doPaging){var rowAtTop=row*options.rowHeight,rowAtBottom=(row+1)*options.rowHeight-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0);(row+1)*options.rowHeight>scrollTop+viewportH+offset?(scrollTo(doPaging?rowAtTop:rowAtBottom),render()):row*options.rowHeight<scrollTop+offset&&(scrollTo(doPaging?rowAtBottom:rowAtTop),render())}function scrollRowToTop(row){scrollTo(row*options.rowHeight),render()}function getColspan(row,cell){var metadata=data.getItemMetadata&&data.getItemMetadata(row);if(!metadata||!metadata.columns)return 1;var columnData=metadata.columns[columns[cell].id]||metadata.columns[cell],colspan=columnData&&columnData.colspan;return colspan="*"===colspan?columns.length-cell:colspan||1}function findFirstFocusableCell(row){for(var cell=0;cell<columns.length;){if(canCellBeActive(row,cell))return cell;cell+=getColspan(row,cell)}return null}function findLastFocusableCell(row){for(var cell=0,lastFocusableCell=null;cell<columns.length;)canCellBeActive(row,cell)&&(lastFocusableCell=cell),cell+=getColspan(row,cell);return lastFocusableCell}function gotoRight(row,cell){if(cell>=columns.length)return null;do cell+=getColspan(row,cell);while(cell<columns.length&&!canCellBeActive(row,cell));return cell<columns.length?{row:row,cell:cell,posX:cell}:null}function gotoLeft(row,cell){if(0>=cell)return null;var firstFocusableCell=findFirstFocusableCell(row);if(null===firstFocusableCell||firstFocusableCell>=cell)return null;for(var pos,prev={row:row,cell:firstFocusableCell,posX:firstFocusableCell};;){if(pos=gotoRight(prev.row,prev.cell,prev.posX),!pos)return null;if(pos.cell>=cell)return prev;prev=pos}}function gotoDown(row,cell,posX){for(var prevCell;;){if(++row>=getDataLength()+(options.enableAddRow?1:0))return null;for(prevCell=cell=0;posX>=cell;)prevCell=cell,cell+=getColspan(row,cell);if(canCellBeActive(row,prevCell))return{row:row,cell:prevCell,posX:posX}}}function gotoUp(row,cell,posX){for(var prevCell;;){if(--row<0)return null;for(prevCell=cell=0;posX>=cell;)prevCell=cell,cell+=getColspan(row,cell);if(canCellBeActive(row,prevCell))return{row:row,cell:prevCell,posX:posX}}}function gotoNext(row,cell,posX){if(null==row&&null==cell&&(row=cell=posX=0,canCellBeActive(row,cell)))return{row:row,cell:cell,posX:cell};var pos=gotoRight(row,cell,posX);if(pos)return pos;for(var firstFocusableCell=null;++row<getDataLength()+(options.enableAddRow?1:0);)if(firstFocusableCell=findFirstFocusableCell(row),null!==firstFocusableCell)return{row:row,cell:firstFocusableCell,posX:firstFocusableCell};return null}function gotoPrev(row,cell,posX){if(null==row&&null==cell&&(row=getDataLength()+(options.enableAddRow?1:0)-1,cell=posX=columns.length-1,canCellBeActive(row,cell)))return{row:row,cell:cell,posX:cell};
for(var pos,lastSelectableCell;!pos&&!(pos=gotoLeft(row,cell,posX));){if(--row<0)return null;cell=0,lastSelectableCell=findLastFocusableCell(row),null!==lastSelectableCell&&(pos={row:row,cell:lastSelectableCell,posX:lastSelectableCell})}return pos}function navigateRight(){return navigate("right")}function navigateLeft(){return navigate("left")}function navigateDown(){return navigate("down")}function navigateUp(){return navigate("up")}function navigateNext(){return navigate("next")}function navigatePrev(){return navigate("prev")}function navigate(dir){if(!options.enableCellNavigation)return!1;if(!activeCellNode&&"prev"!=dir&&"next"!=dir)return!1;if(!getEditorLock().commitCurrentEdit())return!0;setFocus();var tabbingDirections={up:-1,down:1,left:-1,right:1,prev:-1,next:1};tabbingDirection=tabbingDirections[dir];var stepFunctions={up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext},stepFn=stepFunctions[dir],pos=stepFn(activeRow,activeCell,activePosX);if(pos){var isAddNewRow=pos.row==getDataLength();return scrollCellIntoView(pos.row,pos.cell,!isAddNewRow),setActiveCellInternal(getCellNode(pos.row,pos.cell),isAddNewRow||options.autoEdit),activePosX=pos.posX,!0}return setActiveCellInternal(getCellNode(activeRow,activeCell),activeRow==getDataLength()||options.autoEdit),!1}function getCellNode(row,cell){return rowsCache[row]?(ensureCellNodesInRowsCache(row),rowsCache[row].cellNodesByColumnIdx[cell]):null}function setActiveCell(row,cell){initialized&&(row>getDataLength()||0>row||cell>=columns.length||0>cell||options.enableCellNavigation&&(scrollCellIntoView(row,cell,!1),setActiveCellInternal(getCellNode(row,cell),!1)))}function canCellBeActive(row,cell){if(!options.enableCellNavigation||row>=getDataLength()+(options.enableAddRow?1:0)||0>row||cell>=columns.length||0>cell)return!1;var rowMetadata=data.getItemMetadata&&data.getItemMetadata(row);if(rowMetadata&&"boolean"==typeof rowMetadata.focusable)return rowMetadata.focusable;var columnMetadata=rowMetadata&&rowMetadata.columns;return columnMetadata&&columnMetadata[columns[cell].id]&&"boolean"==typeof columnMetadata[columns[cell].id].focusable?columnMetadata[columns[cell].id].focusable:columnMetadata&&columnMetadata[cell]&&"boolean"==typeof columnMetadata[cell].focusable?columnMetadata[cell].focusable:columns[cell].focusable}function canCellBeSelected(row,cell){if(row>=getDataLength()||0>row||cell>=columns.length||0>cell)return!1;var rowMetadata=data.getItemMetadata&&data.getItemMetadata(row);if(rowMetadata&&"boolean"==typeof rowMetadata.selectable)return rowMetadata.selectable;var columnMetadata=rowMetadata&&rowMetadata.columns&&(rowMetadata.columns[columns[cell].id]||rowMetadata.columns[cell]);return columnMetadata&&"boolean"==typeof columnMetadata.selectable?columnMetadata.selectable:columns[cell].selectable}function gotoCell(row,cell,forceEdit){if(initialized&&canCellBeActive(row,cell)&&getEditorLock().commitCurrentEdit()){scrollCellIntoView(row,cell,!1);var newCell=getCellNode(row,cell);setActiveCellInternal(newCell,forceEdit||row===getDataLength()||options.autoEdit),currentEditor||setFocus()}}function commitCurrentEdit(){var item=getDataItem(activeRow),column=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var validationResults=currentEditor.validate();if(validationResults.valid){if(activeRow<getDataLength()){var editCommand={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(item,this.serializedValue),updateRow(this.row)},undo:function(){this.editor.applyValue(item,this.prevSerializedValue),updateRow(this.row)}};options.editCommandHandler?(makeActiveCellNormal(),options.editCommandHandler(item,column,editCommand)):(editCommand.execute(),makeActiveCellNormal()),trigger(self.onCellChange,{row:activeRow,cell:activeCell,item:item})}else{var newItem={};currentEditor.applyValue(newItem,currentEditor.serializeValue()),makeActiveCellNormal(),trigger(self.onAddNewRow,{item:newItem,column:column})}return!getEditorLock().isActive()}return $(activeCellNode).addClass("invalid"),$(activeCellNode).stop(!0,!0).effect("highlight",{color:"red"},300),trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:validationResults,row:activeRow,cell:activeCell,column:column}),currentEditor.focus(),!1}makeActiveCellNormal()}return!0}function cancelCurrentEdit(){return makeActiveCellNormal(),!0}function rowsToRanges(rows){for(var ranges=[],lastCell=columns.length-1,i=0;i<rows.length;i++)ranges.push(new Slick.Range(rows[i],0,rows[i],lastCell));return ranges}function getSelectedRows(){if(!selectionModel)throw"Selection model is not set";return selectedRows}function setSelectedRows(rows){if(!selectionModel)throw"Selection model is not set";selectionModel.setSelectedRanges(rowsToRanges(rows))}var defaults={explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showHeaderRow:!1,headerRowHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,fullWidthRows:!1,multiColumnSort:!1,defaultFormatter:defaultFormatter,forceSyncScrolling:!1},columnDefaults={name:"",resizable:!0,sortable:!1,minWidth:30,rerenderOnResize:!1,headerCssClass:null,defaultSortAsc:!0,focusable:!0,selectable:!0},th,h,ph,n,cj,page=0,offset=0,vScrollDir=1,initialized=!1,$container,uid="slickgrid_"+Math.round(1e6*Math.random()),self=this,$focusSink,$focusSink2,$headerScroller,$headers,$headerRow,$headerRowScroller,$headerRowSpacer,$topPanelScroller,$topPanel,$viewport,$canvas,$style,$boundAncestors,stylesheet,columnCssRulesL,columnCssRulesR,viewportH,viewportW,canvasWidth,viewportHasHScroll,viewportHasVScroll,headerColumnWidthDiff=0,headerColumnHeightDiff=0,cellWidthDiff=0,cellHeightDiff=0,absoluteColumnMinWidth,numberOfRows=0,tabbingDirection=1,activePosX,activeRow,activeCell,activeCellNode=null,currentEditor=null,serializedEditorValue,editController,rowsCache={},renderedRows=0,numVisibleRows,prevScrollTop=0,scrollTop=0,lastRenderedScrollTop=0,lastRenderedScrollLeft=0,prevScrollLeft=0,scrollLeft=0,selectionModel,selectedRows=[],plugins=[],cellCssClasses={},columnsById={},sortColumns=[],columnPosLeft=[],columnPosRight=[],h_editorLoader=null,h_render=null,h_postrender=null,postProcessedRows={},postProcessToRow=null,postProcessFromRow=null,counter_rows_rendered=0,counter_rows_removed=0;this.debug=function(){var s="";s+="\ncounter_rows_rendered:  "+counter_rows_rendered,s+="\ncounter_rows_removed:  "+counter_rows_removed,s+="\nrenderedRows:  "+renderedRows,s+="\nnumVisibleRows:  "+numVisibleRows,s+="\nmaxSupportedCssHeight:  "+maxSupportedCssHeight,s+="\nn(umber of pages):  "+n,s+="\n(current) page:  "+page,s+="\npage height (ph):  "+ph,s+="\nvScrollDir:  "+vScrollDir,alert(s)},this.eval=function(expr){return eval(expr)},$.extend(this,{slickGridVersion:"2.1",onScroll:new Slick.Event,onSort:new Slick.Event,onHeaderMouseEnter:new Slick.Event,onHeaderMouseLeave:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onHeaderCellRendered:new Slick.Event,onBeforeHeaderCellDestroy:new Slick.Event,onHeaderRowCellRendered:new Slick.Event,onBeforeHeaderRowCellDestroy:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,onKeyDown:new Slick.Event,onAddNewRow:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsResized:new Slick.Event,onCellChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,onSelectedRowsChanged:new Slick.Event,onCellCssStylesChanged:new Slick.Event,registerPlugin:registerPlugin,unregisterPlugin:unregisterPlugin,getColumns:getColumns,setColumns:setColumns,getColumnIndex:getColumnIndex,updateColumnHeader:updateColumnHeader,setSortColumn:setSortColumn,setSortColumns:setSortColumns,getSortColumns:getSortColumns,autosizeColumns:autosizeColumns,getOptions:getOptions,setOptions:setOptions,getData:getData,getDataLength:getDataLength,getDataItem:getDataItem,setData:setData,getSelectionModel:getSelectionModel,setSelectionModel:setSelectionModel,getSelectedRows:getSelectedRows,setSelectedRows:setSelectedRows,getContainerNode:getContainerNode,render:render,invalidate:invalidate,invalidateRow:invalidateRow,invalidateRows:invalidateRows,invalidateAllRows:invalidateAllRows,updateCell:updateCell,updateRow:updateRow,getViewport:getVisibleRange,getRenderedRange:getRenderedRange,resizeCanvas:resizeCanvas,updateRowCount:updateRowCount,scrollRowIntoView:scrollRowIntoView,scrollRowToTop:scrollRowToTop,scrollCellIntoView:scrollCellIntoView,getCanvasNode:getCanvasNode,focus:setFocus,getCellFromPoint:getCellFromPoint,getCellFromEvent:getCellFromEvent,getActiveCell:getActiveCell,setActiveCell:setActiveCell,getActiveCellNode:getActiveCellNode,getActiveCellPosition:getActiveCellPosition,resetActiveCell:resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor:getCellEditor,getCellNode:getCellNode,getCellNodeBox:getCellNodeBox,canCellBeSelected:canCellBeSelected,canCellBeActive:canCellBeActive,navigatePrev:navigatePrev,navigateNext:navigateNext,navigateUp:navigateUp,navigateDown:navigateDown,navigateLeft:navigateLeft,navigateRight:navigateRight,gotoCell:gotoCell,getTopPanel:getTopPanel,setTopPanelVisibility:setTopPanelVisibility,setHeaderRowVisibility:setHeaderRowVisibility,getHeaderRow:getHeaderRow,getHeaderRowColumn:getHeaderRowColumn,getGridPosition:getGridPosition,flashCell:flashCell,addCellCssStyles:addCellCssStyles,setCellCssStyles:setCellCssStyles,removeCellCssStyles:removeCellCssStyles,getCellCssStyles:getCellCssStyles,init:finishInitialization,destroy:destroy,getEditorLock:getEditorLock,getEditController:getEditController}),init()}$.extend(!0,window,{Slick:{Grid:SlickGrid}});var scrollbarDimensions,maxSupportedCssHeight}(jQuery),function($){function DataView(options){function beginUpdate(){suspend=!0}function endUpdate(){suspend=!1,refresh()}function setRefreshHints(hints){refreshHints=hints}function setFilterArgs(args){filterArgs=args}function updateIdxById(startingIndex){startingIndex=startingIndex||0;for(var id,i=startingIndex,l=items.length;l>i;i++){if(id=items[i][idProperty],void 0===id)throw"Each data element must implement a unique 'id' property";idxById[id]=i}}function ensureIdUniqueness(){for(var id,i=0,l=items.length;l>i;i++)if(id=items[i][idProperty],void 0===id||idxById[id]!==i)throw"Each data element must implement a unique 'id' property"}function getItems(){return items}function setItems(data,objectIdProperty){void 0!==objectIdProperty&&(idProperty=objectIdProperty),items=filteredItems=data,idxById={},updateIdxById(),ensureIdUniqueness(),refresh()}function setPagingOptions(args){void 0!=args.pageSize&&(pagesize=args.pageSize,pagenum=pagesize?Math.min(pagenum,Math.max(0,Math.ceil(totalRows/pagesize)-1)):0),void 0!=args.pageNum&&(pagenum=Math.min(args.pageNum,Math.max(0,Math.ceil(totalRows/pagesize)-1))),onPagingInfoChanged.notify(getPagingInfo(),null,self),refresh()}function getPagingInfo(){var totalPages=pagesize?Math.max(1,Math.ceil(totalRows/pagesize)):1;return{pageSize:pagesize,pageNum:pagenum,totalRows:totalRows,totalPages:totalPages}}function sort(comparer,ascending){sortAsc=ascending,sortComparer=comparer,fastSortField=null,ascending===!1&&items.reverse(),items.sort(comparer),ascending===!1&&items.reverse(),idxById={},updateIdxById(),refresh()}function fastSort(field,ascending){sortAsc=ascending,fastSortField=field,sortComparer=null;var oldToString=Object.prototype.toString;Object.prototype.toString="function"==typeof field?field:function(){return this[field]},ascending===!1&&items.reverse(),items.sort(),Object.prototype.toString=oldToString,ascending===!1&&items.reverse(),idxById={},updateIdxById(),refresh()}function reSort(){sortComparer?sort(sortComparer,sortAsc):fastSortField&&fastSort(fastSortField,sortAsc)}function setFilter(filterFn){filter=filterFn,options.inlineFilters&&(compiledFilter=compileFilter(),compiledFilterWithCaching=compileFilterWithCaching()),refresh()}function getGrouping(){return groupingInfos}function setGrouping(groupingInfo){options.groupItemMetadataProvider||(options.groupItemMetadataProvider=new Slick.Data.GroupItemMetadataProvider),groups=[],toggledGroupsByLevel=[],groupingInfo=groupingInfo||[],groupingInfos=groupingInfo instanceof Array?groupingInfo:[groupingInfo];for(var i=0;i<groupingInfos.length;i++){var gi=groupingInfos[i]=$.extend(!0,{},groupingInfoDefaults,groupingInfos[i]);gi.getterIsAFn="function"==typeof gi.getter,gi.compiledAccumulators=[];for(var idx=gi.aggregators.length;idx--;)gi.compiledAccumulators[idx]=compileAccumulatorLoop(gi.aggregators[idx]);toggledGroupsByLevel[i]={}}refresh()}function groupBy(valueGetter,valueFormatter,sortComparer){return null==valueGetter?(setGrouping([]),void 0):(setGrouping({getter:valueGetter,formatter:valueFormatter,comparer:sortComparer}),void 0)}function setAggregators(groupAggregators,includeCollapsed){if(!groupingInfos.length)throw new Error("At least one grouping must be specified before calling setAggregators().");groupingInfos[0].aggregators=groupAggregators,groupingInfos[0].aggregateCollapsed=includeCollapsed,setGrouping(groupingInfos)}function getItemByIdx(i){return items[i]}function getIdxById(id){return idxById[id]}function ensureRowsByIdCache(){if(!rowsById){rowsById={};for(var i=0,l=rows.length;l>i;i++)rowsById[rows[i][idProperty]]=i}}function getRowById(id){return ensureRowsByIdCache(),rowsById[id]}function getItemById(id){return items[idxById[id]]}function mapIdsToRows(idArray){var rows=[];ensureRowsByIdCache();for(var i=0;i<idArray.length;i++){var row=rowsById[idArray[i]];null!=row&&(rows[rows.length]=row)}return rows}function mapRowsToIds(rowArray){for(var ids=[],i=0;i<rowArray.length;i++)rowArray[i]<rows.length&&(ids[ids.length]=rows[rowArray[i]][idProperty]);return ids}function updateItem(id,item){if(void 0===idxById[id]||id!==item[idProperty])throw"Invalid or non-matching id";items[idxById[id]]=item,updated||(updated={}),updated[id]=!0,refresh()}function insertItem(insertBefore,item){items.splice(insertBefore,0,item),updateIdxById(insertBefore),refresh()}function addItem(item){items.push(item),updateIdxById(items.length-1),refresh()}function deleteItem(id){var idx=idxById[id];if(void 0===idx)throw"Invalid id";delete idxById[id],items.splice(idx,1),updateIdxById(idx),refresh()}function getLength(){return rows.length}function getItem(i){return rows[i]}function getItemMetadata(i){var item=rows[i];return void 0===item?null:item.__group?options.groupItemMetadataProvider.getGroupRowMetadata(item):item.__groupTotals?options.groupItemMetadataProvider.getTotalsRowMetadata(item):null}function expandCollapseAllGroups(level,collapse){if(null==level)for(var i=0;i<groupingInfos.length;i++)toggledGroupsByLevel[i]={},groupingInfos[i].collapsed=collapse;else toggledGroupsByLevel[level]={},groupingInfos[level].collapsed=collapse;refresh()}function collapseAllGroups(level){expandCollapseAllGroups(level,!0)}function expandAllGroups(level){expandCollapseAllGroups(level,!1)}function expandCollapseGroup(level,groupingKey,collapse){toggledGroupsByLevel[level][groupingKey]=groupingInfos[level].collapsed^collapse,refresh()}function collapseGroup(){var args=Array.prototype.slice.call(arguments),arg0=args[0];1==args.length&&-1!=arg0.indexOf(groupingDelimiter)?expandCollapseGroup(arg0.split(groupingDelimiter).length-1,arg0,!0):expandCollapseGroup(args.length-1,args.join(groupingDelimiter),!0)}function expandGroup(){var args=Array.prototype.slice.call(arguments),arg0=args[0];1==args.length&&-1!=arg0.indexOf(groupingDelimiter)?expandCollapseGroup(arg0.split(groupingDelimiter).length-1,arg0,!1):expandCollapseGroup(args.length-1,args.join(groupingDelimiter),!1)}function getGroups(){return groups}function extractGroups(rows,parentGroup){for(var group,val,r,groups=[],groupsByVal=[],level=parentGroup?parentGroup.level+1:0,gi=groupingInfos[level],i=0,l=gi.predefinedValues.length;l>i;i++)val=gi.predefinedValues[i],group=groupsByVal[val],group||(group=new Slick.Group,group.value=val,group.level=level,group.groupingKey=(parentGroup?parentGroup.groupingKey+groupingDelimiter:"")+val,groups[groups.length]=group,groupsByVal[val]=group);for(var i=0,l=rows.length;l>i;i++)r=rows[i],val=gi.getterIsAFn?gi.getter(r):r[gi.getter],group=groupsByVal[val],group||(group=new Slick.Group,group.value=val,group.level=level,group.groupingKey=(parentGroup?parentGroup.groupingKey+groupingDelimiter:"")+val,groups[groups.length]=group,groupsByVal[val]=group),group.rows[group.count++]=r;if(level<groupingInfos.length-1)for(var i=0;i<groups.length;i++)group=groups[i],group.groups=extractGroups(group.rows,group);return groups.sort(groupingInfos[level].comparer),groups}function calculateGroupTotals(group){for(var agg,gi=groupingInfos[group.level],isLeafLevel=group.level==groupingInfos.length,totals=new Slick.GroupTotals,idx=gi.aggregators.length;idx--;)agg=gi.aggregators[idx],agg.init(),gi.compiledAccumulators[idx].call(agg,!isLeafLevel&&gi.aggregateChildGroups?group.groups:group.rows),agg.storeResult(totals);totals.group=group,group.totals=totals}function calculateTotals(groups,level){level=level||0;for(var g,gi=groupingInfos[level],idx=groups.length;idx--;)g=groups[idx],(!g.collapsed||gi.aggregateCollapsed)&&(g.groups&&calculateTotals(g.groups,level+1),gi.aggregators.length&&(gi.aggregateEmpty||g.rows.length||g.groups&&g.groups.length)&&calculateGroupTotals(g))}function finalizeGroups(groups,level){level=level||0;for(var g,gi=groupingInfos[level],groupCollapsed=gi.collapsed,toggledGroups=toggledGroupsByLevel[level],idx=groups.length;idx--;)g=groups[idx],g.collapsed=groupCollapsed^toggledGroups[g.groupingKey],g.title=gi.formatter?gi.formatter(g):g.value,g.groups&&(finalizeGroups(g.groups,level+1),g.rows=[])}function flattenGroupedRows(groups,level){level=level||0;for(var rows,g,gi=groupingInfos[level],groupedRows=[],gl=0,i=0,l=groups.length;l>i;i++){if(g=groups[i],groupedRows[gl++]=g,!g.collapsed){rows=g.groups?flattenGroupedRows(g.groups,level+1):g.rows;for(var j=0,jj=rows.length;jj>j;j++)groupedRows[gl++]=rows[j]}g.totals&&gi.displayTotalsRow&&(!g.collapsed||gi.aggregateCollapsed)&&(groupedRows[gl++]=g.totals)}return groupedRows}function getFunctionInfo(fn){var fnRegex=/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/,matches=fn.toString().match(fnRegex);return{params:matches[1].split(","),body:matches[2]}}function compileAccumulatorLoop(aggregator){var accumulatorInfo=getFunctionInfo(aggregator.accumulate),fn=new Function("_items","for (var "+accumulatorInfo.params[0]+", _i=0, _il=_items.length; _i<_il; _i++) {"+accumulatorInfo.params[0]+" = _items[_i]; "+accumulatorInfo.body+"}");return fn.displayName=fn.name="compiledAccumulatorLoop",fn}function compileFilter(){var filterInfo=getFunctionInfo(filter),filterBody=filterInfo.body.replace(/return false[;}]/gi,"{ continue _coreloop; }").replace(/return true[;}]/gi,"{ _retval[_idx++] = $item$; continue _coreloop; }").replace(/return ([^;}]+?);/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }"),tpl=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");tpl=tpl.replace(/\$filter\$/gi,filterBody),tpl=tpl.replace(/\$item\$/gi,filterInfo.params[0]),tpl=tpl.replace(/\$args\$/gi,filterInfo.params[1]);var fn=new Function("_items,_args",tpl);return fn.displayName=fn.name="compiledFilter",fn}function compileFilterWithCaching(){var filterInfo=getFunctionInfo(filter),filterBody=filterInfo.body.replace(/return false[;}]/gi,"{ continue _coreloop; }").replace(/return true[;}]/gi,"{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }").replace(/return ([^;}]+?);/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }"),tpl=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");tpl=tpl.replace(/\$filter\$/gi,filterBody),tpl=tpl.replace(/\$item\$/gi,filterInfo.params[0]),tpl=tpl.replace(/\$args\$/gi,filterInfo.params[1]);var fn=new Function("_items,_args,_cache",tpl);return fn.displayName=fn.name="compiledFilterWithCaching",fn}function uncompiledFilter(items,args){for(var retval=[],idx=0,i=0,ii=items.length;ii>i;i++)filter(items[i],args)&&(retval[idx++]=items[i]);return retval}function uncompiledFilterWithCaching(items,args,cache){for(var item,retval=[],idx=0,i=0,ii=items.length;ii>i;i++)item=items[i],cache[i]?retval[idx++]=item:filter(item,args)&&(retval[idx++]=item,cache[i]=!0);return retval}function getFilteredAndPagedItems(items){if(filter){var batchFilter=options.inlineFilters?compiledFilter:uncompiledFilter,batchFilterWithCaching=options.inlineFilters?compiledFilterWithCaching:uncompiledFilterWithCaching;refreshHints.isFilterNarrowing?filteredItems=batchFilter(filteredItems,filterArgs):refreshHints.isFilterExpanding?filteredItems=batchFilterWithCaching(items,filterArgs,filterCache):refreshHints.isFilterUnchanged||(filteredItems=batchFilter(items,filterArgs))}else filteredItems=pagesize?items:items.concat();var paged;return pagesize?(filteredItems.length<pagenum*pagesize&&(pagenum=Math.floor(filteredItems.length/pagesize)),paged=filteredItems.slice(pagesize*pagenum,pagesize*pagenum+pagesize)):paged=filteredItems,{totalRows:filteredItems.length,rows:paged}}function getRowDiffs(rows,newRows){var item,r,eitherIsNonData,diff=[],from=0,to=newRows.length;refreshHints&&refreshHints.ignoreDiffsBefore&&(from=Math.max(0,Math.min(newRows.length,refreshHints.ignoreDiffsBefore))),refreshHints&&refreshHints.ignoreDiffsAfter&&(to=Math.min(newRows.length,Math.max(0,refreshHints.ignoreDiffsAfter)));for(var i=from,rl=rows.length;to>i;i++)i>=rl?diff[diff.length]=i:(item=newRows[i],r=rows[i],(groupingInfos.length&&(eitherIsNonData=item.__nonDataRow||r.__nonDataRow)&&item.__group!==r.__group||item.__group&&!item.equals(r)||eitherIsNonData&&(item.__groupTotals||r.__groupTotals)||item[idProperty]!=r[idProperty]||updated&&updated[item[idProperty]])&&(diff[diff.length]=i));return diff}function recalc(_items){rowsById=null,(refreshHints.isFilterNarrowing!=prevRefreshHints.isFilterNarrowing||refreshHints.isFilterExpanding!=prevRefreshHints.isFilterExpanding)&&(filterCache=[]);var filteredItems=getFilteredAndPagedItems(_items);totalRows=filteredItems.totalRows;var newRows=filteredItems.rows;groups=[],groupingInfos.length&&(groups=extractGroups(newRows),groups.length&&(calculateTotals(groups),finalizeGroups(groups),newRows=flattenGroupedRows(groups)));var diff=getRowDiffs(rows,newRows);return rows=newRows,diff}function refresh(){if(!suspend){var countBefore=rows.length,totalRowsBefore=totalRows,diff=recalc(items,filter);pagesize&&pagenum*pagesize>totalRows&&(pagenum=Math.max(0,Math.ceil(totalRows/pagesize)-1),diff=recalc(items,filter)),updated=null,prevRefreshHints=refreshHints,refreshHints={},totalRowsBefore!=totalRows&&onPagingInfoChanged.notify(getPagingInfo(),null,self),countBefore!=rows.length&&onRowCountChanged.notify({previous:countBefore,current:rows.length},null,self),diff.length>0&&onRowsChanged.notify({rows:diff},null,self)}}function syncGridSelection(grid,preserveHidden){function update(){if(selectedRowIds.length>0){inHandler=!0;var selectedRows=self.mapIdsToRows(selectedRowIds);preserveHidden||(selectedRowIds=self.mapRowsToIds(selectedRows)),grid.setSelectedRows(selectedRows),inHandler=!1}}var inHandler,self=this,selectedRowIds=self.mapRowsToIds(grid.getSelectedRows());grid.onSelectedRowsChanged.subscribe(function(){inHandler||(selectedRowIds=self.mapRowsToIds(grid.getSelectedRows()))}),this.onRowsChanged.subscribe(update),this.onRowCountChanged.subscribe(update)}function syncGridCellCssStyles(grid,key){function storeCellCssStyles(hash){hashById={};for(var row in hash){var id=rows[row][idProperty];hashById[id]=hash[row]}}function update(){if(hashById){inHandler=!0,ensureRowsByIdCache();var newHash={};for(var id in hashById){var row=rowsById[id];void 0!=row&&(newHash[row]=hashById[id])}grid.setCellCssStyles(key,newHash),inHandler=!1}}var hashById,inHandler;storeCellCssStyles(grid.getCellCssStyles(key)),grid.onCellCssStylesChanged.subscribe(function(e,args){inHandler||key==args.key&&args.hash&&storeCellCssStyles(args.hash)}),this.onRowsChanged.subscribe(update),this.onRowCountChanged.subscribe(update)}var fastSortField,sortComparer,filterArgs,compiledFilter,compiledFilterWithCaching,self=this,defaults={groupItemMetadataProvider:null,inlineFilters:!1},idProperty="id",items=[],rows=[],idxById={},rowsById=null,filter=null,updated=null,suspend=!1,sortAsc=!0,refreshHints={},prevRefreshHints={},filteredItems=[],filterCache=[],groupingInfoDefaults={getter:null,formatter:null,comparer:function(a,b){return a.value-b.value},predefinedValues:[],aggregators:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0},groupingInfos=[],groups=[],toggledGroupsByLevel=[],groupingDelimiter=":|:",pagesize=0,pagenum=0,totalRows=0,onRowCountChanged=new Slick.Event,onRowsChanged=new Slick.Event,onPagingInfoChanged=new Slick.Event;return options=$.extend(!0,{},defaults,options),{beginUpdate:beginUpdate,endUpdate:endUpdate,setPagingOptions:setPagingOptions,getPagingInfo:getPagingInfo,getItems:getItems,setItems:setItems,setFilter:setFilter,sort:sort,fastSort:fastSort,reSort:reSort,setGrouping:setGrouping,getGrouping:getGrouping,groupBy:groupBy,setAggregators:setAggregators,collapseAllGroups:collapseAllGroups,expandAllGroups:expandAllGroups,collapseGroup:collapseGroup,expandGroup:expandGroup,getGroups:getGroups,getIdxById:getIdxById,getRowById:getRowById,getItemById:getItemById,getItemByIdx:getItemByIdx,mapRowsToIds:mapRowsToIds,mapIdsToRows:mapIdsToRows,setRefreshHints:setRefreshHints,setFilterArgs:setFilterArgs,refresh:refresh,updateItem:updateItem,insertItem:insertItem,addItem:addItem,deleteItem:deleteItem,syncGridSelection:syncGridSelection,syncGridCellCssStyles:syncGridCellCssStyles,getLength:getLength,getItem:getItem,getItemMetadata:getItemMetadata,onRowCountChanged:onRowCountChanged,onRowsChanged:onRowsChanged,onPagingInfoChanged:onPagingInfoChanged}}function AvgAggregator(field){this.field_=field,this.init=function(){this.count_=0,this.nonNullCount_=0,this.sum_=0},this.accumulate=function(item){var val=item[this.field_];this.count_++,null!=val&&""!==val&&0/0!==val&&(this.nonNullCount_++,this.sum_+=parseFloat(val))},this.storeResult=function(groupTotals){groupTotals.avg||(groupTotals.avg={}),0!=this.nonNullCount_&&(groupTotals.avg[this.field_]=this.sum_/this.nonNullCount_)}}function MinAggregator(field){this.field_=field,this.init=function(){this.min_=null},this.accumulate=function(item){var val=item[this.field_];null!=val&&""!==val&&0/0!==val&&(null==this.min_||val<this.min_)&&(this.min_=val)},this.storeResult=function(groupTotals){groupTotals.min||(groupTotals.min={}),groupTotals.min[this.field_]=this.min_}}function MaxAggregator(field){this.field_=field,this.init=function(){this.max_=null},this.accumulate=function(item){var val=item[this.field_];null!=val&&""!==val&&0/0!==val&&(null==this.max_||val>this.max_)&&(this.max_=val)},this.storeResult=function(groupTotals){groupTotals.max||(groupTotals.max={}),groupTotals.max[this.field_]=this.max_}}function SumAggregator(field){this.field_=field,this.init=function(){this.sum_=null},this.accumulate=function(item){var val=item[this.field_];null!=val&&""!==val&&0/0!==val&&(this.sum_+=parseFloat(val))},this.storeResult=function(groupTotals){groupTotals.sum||(groupTotals.sum={}),groupTotals.sum[this.field_]=this.sum_}}$.extend(!0,window,{Slick:{Data:{DataView:DataView,Aggregators:{Avg:AvgAggregator,Min:MinAggregator,Max:MaxAggregator,Sum:SumAggregator}}}})}(jQuery),function($){function CellRangeSelector(options){function init(grid){options=$.extend(!0,{},_defaults,options),_decorator=new Slick.CellRangeDecorator(grid,options),_grid=grid,_canvas=_grid.getCanvasNode(),_handler.subscribe(_grid.onDragInit,handleDragInit).subscribe(_grid.onDragStart,handleDragStart).subscribe(_grid.onDrag,handleDrag).subscribe(_grid.onDragEnd,handleDragEnd)}function destroy(){_handler.unsubscribeAll()}function handleDragInit(e){e.stopImmediatePropagation()}function handleDragStart(e,dd){var cell=_grid.getCellFromEvent(e);if(_self.onBeforeCellRangeSelected.notify(cell)!==!1&&_grid.canCellBeSelected(cell.row,cell.cell)&&(_dragging=!0,e.stopImmediatePropagation()),_dragging){_grid.focus();var start=_grid.getCellFromPoint(dd.startX-$(_canvas).offset().left,dd.startY-$(_canvas).offset().top);return dd.range={start:start,end:{}},_decorator.show(new Slick.Range(start.row,start.cell))}}function handleDrag(e,dd){if(_dragging){e.stopImmediatePropagation();var end=_grid.getCellFromPoint(e.pageX-$(_canvas).offset().left,e.pageY-$(_canvas).offset().top);_grid.canCellBeSelected(end.row,end.cell)&&(dd.range.end=end,_decorator.show(new Slick.Range(dd.range.start.row,dd.range.start.cell,end.row,end.cell)))}}function handleDragEnd(e,dd){_dragging&&(_dragging=!1,e.stopImmediatePropagation(),_decorator.hide(),_self.onCellRangeSelected.notify({range:new Slick.Range(dd.range.start.row,dd.range.start.cell,dd.range.end.row,dd.range.end.cell)}))}var _grid,_canvas,_dragging,_decorator,_self=this,_handler=new Slick.EventHandler,_defaults={selectionCss:{border:"2px dashed blue"}};$.extend(this,{init:init,destroy:destroy,onBeforeCellRangeSelected:new Slick.Event,onCellRangeSelected:new Slick.Event})}$.extend(!0,window,{Slick:{CellRangeSelector:CellRangeSelector}})}(jQuery),function($){function CellSelectionModel(options){function init(grid){_options=$.extend(!0,{},_defaults,options),_grid=grid,_canvas=_grid.getCanvasNode(),_grid.onActiveCellChanged.subscribe(handleActiveCellChange),_grid.onKeyDown.subscribe(handleKeyDown),grid.registerPlugin(_selector),_selector.onCellRangeSelected.subscribe(handleCellRangeSelected),_selector.onBeforeCellRangeSelected.subscribe(handleBeforeCellRangeSelected)}function destroy(){_grid.onActiveCellChanged.unsubscribe(handleActiveCellChange),_grid.onKeyDown.unsubscribe(handleKeyDown),_selector.onCellRangeSelected.unsubscribe(handleCellRangeSelected),_selector.onBeforeCellRangeSelected.unsubscribe(handleBeforeCellRangeSelected),_grid.unregisterPlugin(_selector)}function removeInvalidRanges(ranges){for(var result=[],i=0;i<ranges.length;i++){var r=ranges[i];_grid.canCellBeSelected(r.fromRow,r.fromCell)&&_grid.canCellBeSelected(r.toRow,r.toCell)&&result.push(r)}return result}function setSelectedRanges(ranges){_ranges=removeInvalidRanges(ranges),_self.onSelectedRangesChanged.notify(_ranges)}function getSelectedRanges(){return _ranges}function handleBeforeCellRangeSelected(e){return _grid.getEditorLock().isActive()?(e.stopPropagation(),!1):void 0}function handleCellRangeSelected(e,args){setSelectedRanges([args.range])}function handleActiveCellChange(e,args){_options.selectActiveCell&&null!=args.row&&null!=args.cell&&setSelectedRanges([new Slick.Range(args.row,args.cell)])
}function handleKeyDown(e){var ranges,last,active=_grid.getActiveCell();if(active&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&(37==e.which||39==e.which||38==e.which||40==e.which)){ranges=getSelectedRanges(),ranges.length||ranges.push(new Slick.Range(active.row,active.cell)),last=ranges.pop(),last.contains(active.row,active.cell)||(last=new Slick.Range(active.row,active.cell));var dRow=last.toRow-last.fromRow,dCell=last.toCell-last.fromCell,dirRow=active.row==last.fromRow?1:-1,dirCell=active.cell==last.fromCell?1:-1;37==e.which?dCell-=dirCell:39==e.which?dCell+=dirCell:38==e.which?dRow-=dirRow:40==e.which&&(dRow+=dirRow);var new_last=new Slick.Range(active.row,active.cell,active.row+dirRow*dRow,active.cell+dirCell*dCell);removeInvalidRanges([new_last]).length?(ranges.push(new_last),_grid.scrollRowIntoView(dirRow>0?new_last.toRow:new_last.fromRow),_grid.scrollCellIntoView(new_last.fromRow,dirCell>0?new_last.toCell:new_last.fromCell)):ranges.push(last),setSelectedRanges(ranges),e.preventDefault(),e.stopPropagation()}}var _grid,_canvas,_options,_ranges=[],_self=this,_selector=new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}}),_defaults={selectActiveCell:!0};$.extend(this,{getSelectedRanges:getSelectedRanges,setSelectedRanges:setSelectedRanges,init:init,destroy:destroy,onSelectedRangesChanged:new Slick.Event})}$.extend(!0,window,{Slick:{CellSelectionModel:CellSelectionModel}})}(jQuery),function($){function RowSelectionModel(options){function init(grid){_options=$.extend(!0,{},_defaults,options),_grid=grid,_handler.subscribe(_grid.onActiveCellChanged,wrapHandler(handleActiveCellChange)),_handler.subscribe(_grid.onKeyDown,wrapHandler(handleKeyDown)),_handler.subscribe(_grid.onClick,wrapHandler(handleClick))}function destroy(){_handler.unsubscribeAll()}function wrapHandler(handler){return function(){_inHandler||(_inHandler=!0,handler.apply(this,arguments),_inHandler=!1)}}function rangesToRows(ranges){for(var rows=[],i=0;i<ranges.length;i++)for(var j=ranges[i].fromRow;j<=ranges[i].toRow;j++)rows.push(j);return rows}function rowsToRanges(rows){for(var ranges=[],lastCell=_grid.getColumns().length-1,i=0;i<rows.length;i++)ranges.push(new Slick.Range(rows[i],0,rows[i],lastCell));return ranges}function getRowsRange(from,to){var i,rows=[];for(i=from;to>=i;i++)rows.push(i);for(i=to;from>i;i++)rows.push(i);return rows}function getSelectedRows(){return rangesToRows(_ranges)}function setSelectedRows(rows){setSelectedRanges(rowsToRanges(rows))}function setSelectedRanges(ranges){_ranges=ranges,_self.onSelectedRangesChanged.notify(_ranges)}function getSelectedRanges(){return _ranges}function handleActiveCellChange(e,data){_options.selectActiveRow&&null!=data.row&&setSelectedRanges([new Slick.Range(data.row,0,data.row,_grid.getColumns().length-1)])}function handleKeyDown(e){var activeRow=_grid.getActiveCell();if(activeRow&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&(38==e.which||40==e.which)){var selectedRows=getSelectedRows();selectedRows.sort(function(x,y){return x-y}),selectedRows.length||(selectedRows=[activeRow.row]);var active,top=selectedRows[0],bottom=selectedRows[selectedRows.length-1];active=40==e.which?activeRow.row<bottom||top==bottom?++bottom:++top:activeRow.row<bottom?--bottom:--top,active>=0&&active<_grid.getDataLength()&&(_grid.scrollRowIntoView(active),_ranges=rowsToRanges(getRowsRange(top,bottom)),setSelectedRanges(_ranges)),e.preventDefault(),e.stopPropagation()}}function handleClick(e){var cell=_grid.getCellFromEvent(e);if(!cell||!_grid.canCellBeActive(cell.row,cell.cell))return!1;var selection=rangesToRows(_ranges),idx=$.inArray(cell.row,selection);if(!(e.ctrlKey||e.shiftKey||e.metaKey))return!1;if(_grid.getOptions().multiSelect)if(-1===idx&&(e.ctrlKey||e.metaKey))selection.push(cell.row),_grid.setActiveCell(cell.row,cell.cell);else if(-1!==idx&&(e.ctrlKey||e.metaKey))selection=$.grep(selection,function(o){return o!==cell.row}),_grid.setActiveCell(cell.row,cell.cell);else if(selection.length&&e.shiftKey){var last=selection.pop(),from=Math.min(cell.row,last),to=Math.max(cell.row,last);selection=[];for(var i=from;to>=i;i++)i!==last&&selection.push(i);selection.push(last),_grid.setActiveCell(cell.row,cell.cell)}return _ranges=rowsToRanges(selection),setSelectedRanges(_ranges),e.stopImmediatePropagation(),!0}var _grid,_inHandler,_options,_ranges=[],_self=this,_handler=new Slick.EventHandler,_defaults={selectActiveRow:!0};$.extend(this,{getSelectedRows:getSelectedRows,setSelectedRows:setSelectedRows,getSelectedRanges:getSelectedRanges,setSelectedRanges:setSelectedRanges,init:init,destroy:destroy,onSelectedRangesChanged:new Slick.Event})}$.extend(!0,window,{Slick:{RowSelectionModel:RowSelectionModel}})}(jQuery),function($){function RowMoveManager(options){function init(grid){options=$.extend(!0,{},_defaults,options),_grid=grid,_canvas=_grid.getCanvasNode(),_handler.subscribe(_grid.onDragInit,handleDragInit).subscribe(_grid.onDragStart,handleDragStart).subscribe(_grid.onDrag,handleDrag).subscribe(_grid.onDragEnd,handleDragEnd)}function destroy(){_handler.unsubscribeAll()}function handleDragInit(e){e.stopImmediatePropagation()}function handleDragStart(e,dd){var cell=_grid.getCellFromEvent(e);if(options.cancelEditOnDrag&&_grid.getEditorLock().isActive()&&_grid.getEditorLock().cancelCurrentEdit(),_grid.getEditorLock().isActive()||!/move|selectAndMove/.test(_grid.getColumns()[cell.cell].behavior))return!1;_dragging=!0,e.stopImmediatePropagation();var selectedRows=_grid.getSelectedRows();(0==selectedRows.length||-1==$.inArray(cell.row,selectedRows))&&(selectedRows=[cell.row],_grid.setSelectedRows(selectedRows));var rowHeight=_grid.getOptions().rowHeight;dd.selectedRows=selectedRows,dd.selectionProxy=$("<div class='slick-reorder-proxy'/>").css("position","absolute").css("zIndex","99999").css("width",$(_canvas).innerWidth()).css("height",rowHeight*selectedRows.length).appendTo(_canvas),dd.guide=$("<div class='slick-reorder-guide'/>").css("position","absolute").css("zIndex","99998").css("width",$(_canvas).innerWidth()).css("top",-1e3).appendTo(_canvas),dd.insertBefore=-1}function handleDrag(e,dd){if(_dragging){e.stopImmediatePropagation();var top=e.pageY-$(_canvas).offset().top;dd.selectionProxy.css("top",top-5);var insertBefore=Math.max(0,Math.min(Math.round(top/_grid.getOptions().rowHeight),_grid.getDataLength()));if(insertBefore!==dd.insertBefore){var eventData={rows:dd.selectedRows,insertBefore:insertBefore};_self.onBeforeMoveRows.notify(eventData)===!1?(dd.guide.css("top",-1e3),dd.canMove=!1):(dd.guide.css("top",insertBefore*_grid.getOptions().rowHeight),dd.canMove=!0),dd.insertBefore=insertBefore}}}function handleDragEnd(e,dd){if(_dragging&&(_dragging=!1,e.stopImmediatePropagation(),dd.guide.remove(),dd.selectionProxy.remove(),dd.canMove)){var eventData={rows:dd.selectedRows,insertBefore:dd.insertBefore};_self.onMoveRows.notify(eventData)}}var _grid,_canvas,_dragging,_self=this,_handler=new Slick.EventHandler,_defaults={cancelEditOnDrag:!1};$.extend(this,{onBeforeMoveRows:new Slick.Event,onMoveRows:new Slick.Event,init:init,destroy:destroy})}$.extend(!0,window,{Slick:{RowMoveManager:RowMoveManager}})}(jQuery);